rm(list=ls())
library(Iso)

fun1<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
               v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54)
{
  g11<-rnorm(n11,0,sqrt(v11));g12<-rnorm(n12,0,sqrt(v12))
  g13<-rnorm(n13,0,sqrt(v13));g14<-rnorm(n14,0,sqrt(v14))
  g21<-rnorm(n21,0,sqrt(v21));g22<-rnorm(n22,0,sqrt(v22))
  g23<-rnorm(n23,0,sqrt(v23));g24<-rnorm(n24,0,sqrt(v24))
  g31<-rnorm(n31,0,sqrt(v31));g32<-rnorm(n32,0,sqrt(v32))
  g33<-rnorm(n33,0,sqrt(v33));g34<-rnorm(n34,0,sqrt(v34))
  g41<-rnorm(n41,0,sqrt(v41));g42<-rnorm(n42,0,sqrt(v42))
  g43<-rnorm(n43,0,sqrt(v43));g44<-rnorm(n44,0,sqrt(v44))
  g51<-rnorm(n51,0,sqrt(v51));g52<-rnorm(n52,0,sqrt(v52))
  g53<-rnorm(n53,0,sqrt(v53));g54<-rnorm(n54,0,sqrt(v54))
  s11=var(g11);s12=var(g12);s13=var(g13);s14=var(g14)
  s21=var(g21);s22=var(g22);s23=var(g23);s24=var(g24)
  s31=var(g31);s32=var(g32);s33=var(g33);s34=var(g34)
  s41=var(g41);s42=var(g42);s43=var(g43);s44=var(g44)
  s51=var(g51);s52=var(g52);s53=var(g53);s54=var(g54)
  m11=mean(g11);m12=mean(g12);m13=mean(g13);m14=mean(g14)
  m21=mean(g21);m22=mean(g22);m23=mean(g23);m24=mean(g24)
  m31=mean(g31);m32=mean(g32);m33=mean(g33);m34=mean(g34)
  m41=mean(g41);m42=mean(g42);m43=mean(g43);m44=mean(g44)
  m51=mean(g51);m52=mean(g52);m53=mean(g53);m54=mean(g54)
  x1=(m11+m12+m13+m14)/4;x2=(m21+m22+m23+m24)/4;x3=(m31+m32+m33+m34)/4
  x4=(m41+m42+m43+m44)/4;x5=(m51+m52+m53+m54)/4
  y1=(m11+m21+m31+m41+m51)/5;y2=(m12+m22+m32+m42+m52)/5;y3=(m13+m23+m33+m43+m53)/5
  y4=(m14+m24+m34+m44+m54)/5
  m=(m11+m12+m13+m14+m21+m22+m23+m24+m31+m32+m33+m34+m41+m42+m43+m44+m51+m52+m53+m54)/20
  A1=c(x1,x2,x3,x4,x5);B1=c(y1-m,y2-m,y3-m,y4-m)
  u11=n11/s11;u12=n12/s12;u13=n13/s13;u14=n14/s14;u21=n21/s21;u22=n22/s22;u23=n23/s23;u24=n24/s24
  u31=n31/s31;u32=n32/s32;u33=n33/s33;u34=n34/s34;u41=n41/s41;u42=n42/s42;u43=n43/s43;u44=n44/s44
  u51=n51/s51;u52=n52/s52;u53=n53/s53;u54=n54/s54
  a10=(u11*(m11-B1[1])+u12*(m12-B1[2])+u13*(m13-B1[3])+u14*(m14-B1[4]))/(u11+u12+u13+u14)
  a11=(u21*(m21-B1[1])+u22*(m22-B1[2])+u23*(m23-B1[3])+u24*(m24-B1[4]))/(u21+u22+u23+u24)
  a12=(u31*(m31-B1[1])+u32*(m32-B1[2])+u33*(m33-B1[3])+u34*(m34-B1[4]))/(u31+u32+u33+u34)
  a13=(u41*(m41-B1[1])+u42*(m42-B1[2])+u43*(m43-B1[3])+u44*(m44-B1[4]))/(u41+u42+u43+u44)
  a14=(u51*(m51-B1[1])+u52*(m52-B1[2])+u53*(m53-B1[3])+u54*(m54-B1[4]))/(u51+u52+u53+u54)
  b10=(u11*(m11-a10)+u21*(m21-a11)+u31*(m31-a12)+u41*(m41-a13)+u51*(m51-a14))/(u11+u21+u31+u41+u51)
  b11=(u12*(m12-a10)+u22*(m22-a11)+u32*(m32-a12)+u42*(m42-a13)+u52*(m52-a14))/(u12+u22+u32+u42+u52)
  b12=(u13*(m13-a10)+u23*(m23-a11)+u33*(m33-a12)+u43*(m43-a13)+u53*(m53-a14))/(u13+u23+u33+u43+u53)
  b13=(u14*(m14-a10)+u24*(m24-a11)+u34*(m34-a12)+u44*(m44-a13)+u54*(m54-a14))/(u14+u24+u34+u44+u54)
  alpha0<-c(a10,a11,a12,a13,a14);beta0<-c(b10,b11,b12,b13)
  x14=alpha0;x15=beta0
  S11=sum((g11-x14[1]-x15[1])^2)/n11;S12=sum((g12-x14[1]-x15[2])^2)/n12
  S13=sum((g13-x14[1]-x15[3])^2)/n13;S14=sum((g14-x14[1]-x15[4])^2)/n14
  S21=sum((g21-x14[2]-x15[1])^2)/n21;S22=sum((g22-x14[2]-x15[2])^2)/n22
  S23=sum((g23-x14[2]-x15[3])^2)/n23;S24=sum((g24-x14[2]-x15[4])^2)/n24
  S31=sum((g31-x14[3]-x15[1])^2)/n31;S32=sum((g32-x14[3]-x15[2])^2)/n32
  S33=sum((g33-x14[3]-x15[3])^2)/n33;S34=sum((g34-x14[3]-x15[4])^2)/n34
  S41=sum((g41-x14[4]-x15[1])^2)/n41;S42=sum((g42-x14[4]-x15[2])^2)/n42
  S43=sum((g43-x14[4]-x15[3])^2)/n43;S44=sum((g44-x14[4]-x15[4])^2)/n44
  S51=sum((g51-x14[5]-x15[1])^2)/n51;S52=sum((g52-x14[5]-x15[2])^2)/n52
  S53=sum((g53-x14[5]-x15[3])^2)/n53;S54=sum((g54-x14[5]-x15[4])^2)/n54
  repeat
  {
    u11=n11/S11;u12=n12/S12;u13=n13/S13;u14=n14/S14;u21=n21/S21;u22=n22/S22;u23=n23/S23;u24=n24/S24
    u31=n31/S31;u32=n32/S32;u33=n33/S33;u34=n34/S34;u41=n41/S41;u42=n42/S42;u43=n43/S43;u44=n44/S44
    u51=n51/S51;u52=n52/S52;u53=n53/S53;u54=n54/S54
    w1=(u11+u12+u13+u14);w2=(u21+u22+u23+u24);w3=(u31+u32+u33+u34)
    w4=(u41+u42+u43+u44);w5=(u51+u52+u53+u54)
    #mu=(u11*x11.+u12*x12.+u13*x13.+u21*x21.+u22*x22.+u23*x23.+u31*x31.+u32*x32.+u33*x33.)/(w1+w2+w3)
    W=c(w1,w2,w3,w4,w5)
    X1=((u11*(m11-beta0[1]))+(u12*(m12-beta0[2]))+(u13*(m13-beta0[3]))+(u14*(m14-beta0[4])))/w1
    X2=((u21*(m21-beta0[1]))+(u22*(m22-beta0[2]))+(u23*(m23-beta0[3]))+(u24*(m24-beta0[4])))/w2
    X3=((u31*(m31-beta0[1]))+(u32*(m32-beta0[2]))+(u33*(m33-beta0[3]))+(u34*(m34-beta0[4])))/w3
    X4=((u41*(m41-beta0[1]))+(u42*(m42-beta0[2]))+(u43*(m43-beta0[3]))+(u44*(m44-beta0[4])))/w4
    X5=((u51*(m51-beta0[1]))+(u52*(m52-beta0[2]))+(u53*(m53-beta0[3]))+(u54*(m54-beta0[4])))/w5
    X=c(X1,X2,X3,X4,X5)
    alpha1=pava(X,W)
    w4=(u11+u21+u31+u41+u51);w5=(u12+u22+u32+u42+u52);w6=(u13+u23+u33+u43+u53);w7=(u14+u24+u34+u44+u54)
    B1=((u11*(m11-alpha1[1]))+(u21*(m21-alpha1[2]))+(u31*(m31-alpha1[3]))+(u41*(m41-alpha1[4]))+(u51*(m51-alpha1[5])))/w4
    B2=((u12*(m12-alpha1[1]))+(u22*(m22-alpha1[2]))+(u32*(m32-alpha1[3]))+(u42*(m42-alpha1[4]))+(u52*(m52-alpha1[5])))/w5
    B3=((u13*(m13-alpha1[1]))+(u23*(m23-alpha1[2]))+(u33*(m33-alpha1[3]))+(u43*(m43-alpha1[4]))+(u53*(m53-alpha1[5])))/w6
    B4=((u14*(m14-alpha1[1]))+(u24*(m24-alpha1[2]))+(u34*(m34-alpha1[3]))+(u44*(m44-alpha1[4]))+(u54*(m54-alpha1[5])))/w7
    beta1=c(B1,B2,B3,B4)
    S111=sum((g11-alpha1[1]-beta1[1])^2)/n11;S112=sum((g12-alpha1[1]-beta1[2])^2)/n12
    S113=sum((g13-alpha1[1]-beta1[3])^2)/n13;S114=sum((g14-alpha1[1]-beta1[4])^2)/n14
    S121=sum((g21-alpha1[2]-beta1[1])^2)/n21;S122=sum((g22-alpha1[2]-beta1[2])^2)/n22
    S123=sum((g23-alpha1[2]-beta1[3])^2)/n23;S124=sum((g24-alpha1[2]-beta1[4])^2)/n24
    S131=sum((g31-alpha1[3]-beta1[1])^2)/n31;S132=sum((g32-alpha1[3]-beta1[2])^2)/n32
    S133=sum((g33-alpha1[3]-beta1[3])^2)/n33;S134=sum((g34-alpha1[3]-beta1[4])^2)/n34
    S141=sum((g41-alpha1[4]-beta1[1])^2)/n41;S142=sum((g42-alpha1[4]-beta1[2])^2)/n42
    S143=sum((g43-alpha1[4]-beta1[3])^2)/n43;S144=sum((g44-alpha1[4]-beta1[4])^2)/n44
    S151=sum((g51-alpha1[5]-beta1[1])^2)/n51;S152=sum((g52-alpha1[5]-beta1[2])^2)/n52
    S153=sum((g53-alpha1[5]-beta1[3])^2)/n53;S154=sum((g54-alpha1[5]-beta1[4])^2)/n54
    M=max(abs(x14-alpha1));N=max(abs(x15-beta1))
    if(M<=0.0000001 & N<=0.0000001)
    {
      break
    }
    S11=S111;S12=S112;S13=S113;S14=S114;S21=S121;S22=S122;S23=S123;S24=S124
    S31=S131;S32=S132;S33=S133;S34=S134;S41=S141;S42=S142;S43=S143;S44=S144
    S51=S151;S52=S152;S53=S153;S54=S154
    x14=alpha1;x15=beta1
  }
  u11=n11/s11;u12=n12/s12;u13=n13/s13;u14=n14/s14;u21=n21/s21;u22=n22/s22;u23=n23/s23;u24=n24/s24
  u31=n31/s31;u32=n32/s32;u33=n33/s33;u34=n34/s34;u41=n41/s41;u42=n42/s42;u43=n43/s43;u44=n44/s44
  u51=n51/s51;u52=n52/s52;u53=n53/s53;u54=n54/s54
  U.1=u11+u21+u31+u41+u51;U.2=u12+u22+u32+u42+u52;U.3=u13+u23+u33+u43+u53;U.4=u14+u24+u34+u44+u54
  beta01=c((u11*m11+u21*m21+u31*m31+u41*m41+u51*m51)/U.1,(u12*m12+u22*m22+u32*m32+u42*m42+u52*m52)/U.2,
           (u13*m13+u23*m23+u33*m33+u43*m43+u53*m53)/U.3,(u14*m14+u24*m24+u34*m34+u44*m44+u54*m54)/U.4)
  x16=beta01
  V11=sum((g11-x16[1])^2)/n11;V12=sum((g12-x16[2])^2)/n12
  V13=sum((g13-x16[3])^2)/n13;V14=sum((g14-x16[4])^2)/n14
  V21=sum((g21-x16[1])^2)/n21;V22=sum((g22-x16[2])^2)/n22
  V23=sum((g23-x16[3])^2)/n23;V24=sum((g24-x16[4])^2)/n24
  V31=sum((g31-x16[1])^2)/n31;V32=sum((g32-x16[2])^2)/n32
  V33=sum((g33-x16[3])^2)/n33;V34=sum((g34-x16[4])^2)/n34
  V41=sum((g41-x16[1])^2)/n41;V42=sum((g42-x16[2])^2)/n42
  V43=sum((g43-x16[3])^2)/n43;V44=sum((g44-x16[4])^2)/n44
  V51=sum((g51-x16[1])^2)/n51;V52=sum((g52-x16[2])^2)/n52
  V53=sum((g53-x16[3])^2)/n53;V54=sum((g54-x16[4])^2)/n54
  repeat
  {
    u11=n11/V11;u12=n12/V12;u13=n13/V13;u14=n14/V14;u21=n21/V21;u22=n22/V22;u23=n23/V23;u24=n24/V24
    u31=n31/V31;u32=n32/V32;u33=n33/V33;u34=n34/V34;u41=n41/V41;u42=n42/V42;u43=n43/V43;u44=n44/V44
    u51=n51/V51;u52=n52/V52;u53=n53/V53;u54=n54/V54
    U.1=u11+u21+u31+u41+u51;U.2=u12+u22+u32+u42+u52;U.3=u13+u23+u33+u43+u53;U.4=u14+u24+u34+u44+u54
    beta11=c((u11*m11+u21*m21+u31*m31+u41*m41+u51*m51)/U.1,(u12*m12+u22*m22+u32*m32+u42*m42+u52*m52)/U.2,
             (u13*m13+u23*m23+u33*m33+u43*m43+u53*m53)/U.3,(u14*m14+u24*m24+u34*m34+u44*m44+u54*m54)/U.4)
    dif=max(abs(x16-beta11))
    if(dif<=0.00001)
    {
      break
    }
    S011=sum((g11-beta11[1])^2)/n11;S012=sum((g12-beta11[2])^2)/n12
    S013=sum((g13-beta11[3])^2)/n13;S014=sum((g14-beta11[4])^2)/n14
    S021=sum((g21-beta11[1])^2)/n21;S022=sum((g22-beta11[2])^2)/n22
    S023=sum((g23-beta11[3])^2)/n23;S024=sum((g24-beta11[4])^2)/n24
    S031=sum((g31-beta11[1])^2)/n31;S032=sum((g32-beta11[2])^2)/n32
    S033=sum((g33-beta11[3])^2)/n33;S034=sum((g34-beta11[4])^2)/n34
    S041=sum((g41-beta11[1])^2)/n41;S042=sum((g42-beta11[2])^2)/n42
    S043=sum((g43-beta11[3])^2)/n43;S044=sum((g44-beta11[4])^2)/n44
    S051=sum((g51-beta11[1])^2)/n51;S052=sum((g52-beta11[2])^2)/n52
    S053=sum((g53-beta11[3])^2)/n53;S054=sum((g54-beta11[4])^2)/n54
    V11=S011;V12=S012;V13=S013;V14=S014;V21=S021;V22=S022;V23=S023;V24=S024
    V31=S031;V32=S032;V33=S033;V34=S034;V41=S041;V42=S042;V43=S043;V44=S044
    V51=S051;V52=S052;V53=S053;V54=S054
    x16=beta11
  }
  neu=(S111^(n11/2))*(S112^(n12/2))*(S113^(n13/2))*(S114^(n14/2))*(S121^(n21/2))*(S122^(n22/2))*(S123^(n23/2))*(S124^(n24/2))*
 (S131^(n31/2))*(S132^(n32/2))*(S133^(n33/2))*(S134^(n34/2))*(S141^(n41/2))*(S142^(n42/2))*(S143^(n43/2))*(S144^(n44/2))*
  (S151^(n51/2))*(S152^(n52/2))*(S153^(n53/2))*(S154^(n54/2))

  dno=(S011^(n11/2))*(S012^(n12/2))*(S013^(n13/2))*(S014^(n14/2))*(S021^(n21/2))*(S022^(n22/2))*(S023^(n23/2))*(S024^(n24/2))*
  (S031^(n31/2))*(S032^(n32/2))*(S033^(n33/2))*(S034^(n34/2))*(S041^(n41/2))*(S042^(n42/2))*(S043^(n43/2))*(S044^(n44/2))*
  (S051^(n51/2))*(S052^(n52/2))*(S053^(n53/2))*(S054^(n54/2))

  value=neu/dno
  return(value)
}


fun2<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
               v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54)
{
  x=replicate(1000,fun1(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
                       v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54))
  y<-sort(x,decreasing=FALSE)
  c<-y[50]
  return(c)
}
fun3<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
               mu11,mu12,mu13,mu14,mu21,mu22,mu23,mu24,mu31,mu32,mu33,mu34,mu41,mu42,mu43,mu44,
               mu51,mu52,mu53,mu54,
               v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54)
{

  ##For generating samples from normal distributions
  g11<-rnorm(n11,mu11,sqrt(v11));g12<-rnorm(n12,mu12,sqrt(v12))
  g13<-rnorm(n13,mu13,sqrt(v13));g14<-rnorm(n14,mu14,sqrt(v14))
  g21<-rnorm(n21,mu21,sqrt(v21));g22<-rnorm(n22,mu22,sqrt(v22))
  g23<-rnorm(n23,mu23,sqrt(v23));g24<-rnorm(n24,mu24,sqrt(v24))
  g31<-rnorm(n31,mu31,sqrt(v31));g32<-rnorm(n32,mu32,sqrt(v32))
  g33<-rnorm(n33,mu33,sqrt(v33));g34<-rnorm(n34,mu34,sqrt(v34))
  g41<-rnorm(n41,mu41,sqrt(v41));g42<-rnorm(n42,mu42,sqrt(v42))
  g43<-rnorm(n43,mu43,sqrt(v43));g44<-rnorm(n44,mu44,sqrt(v44))
  g51<-rnorm(n51,mu51,sqrt(v51));g52<-rnorm(n52,mu52,sqrt(v52))
  g53<-rnorm(n53,mu53,sqrt(v53));g54<-rnorm(n54,mu54,sqrt(v54))
  ##For generating samples from t distribution
  #Y11=rt(n11,3,ncp=0)/sqrt(3);Y12=rt(n12,3,ncp=0)/sqrt(3);Y13=rt(n13,3,ncp=0)/sqrt(3)
  #Y14=rt(n14,3,ncp=0)/sqrt(3)
  #Y21=rt(n21,3,ncp=0)/sqrt(3);Y22=rt(n22,3,ncp=0)/sqrt(3);Y23=rt(n23,3,ncp=0)/sqrt(3)
  #Y24=rt(n24,3,ncp=0)/sqrt(3)
  #Y31=rt(n31,3,ncp=0)/sqrt(3);Y32=rt(n32,3,ncp=0)/sqrt(3);Y33=rt(n33,3,ncp=0)/sqrt(3)
  #Y34=rt(n34,3,ncp=0)/sqrt(3)
  #Y41=rt(n41,3,ncp=0)/sqrt(3);Y42=rt(n42,3,ncp=0)/sqrt(3);Y43=rt(n43,3,ncp=0)/sqrt(3)
  #Y44=rt(n44,3,ncp=0)/sqrt(3)
  #Y51=rt(n51,3,ncp=0)/sqrt(3);Y52=rt(n52,3,ncp=0)/sqrt(3);Y53=rt(n53,3,ncp=0)/sqrt(3)
  #Y54=rt(n54,3,ncp=0)/sqrt(3)
  #g11=sqrt(v11)*Y11+mu11;g12=sqrt(v12)*Y12+mu12;g13=sqrt(v13)*Y13+mu13;g14=sqrt(v14)*Y14+mu14
  #g21=sqrt(v21)*Y21+mu21;g22=sqrt(v22)*Y22+mu22;g23=sqrt(v23)*Y23+mu23;g24=sqrt(v24)*Y24+mu24
  #g31=sqrt(v31)*Y31+mu31;g32=sqrt(v32)*Y32+mu32;g33=sqrt(v33)*Y33+mu33;g34=sqrt(v34)*Y34+mu34
  #g41=sqrt(v41)*Y41+mu41;g42=sqrt(v42)*Y42+mu42;g43=sqrt(v43)*Y43+mu43;g44=sqrt(v44)*Y44+mu44
  #g51=sqrt(v51)*Y51+mu51;g52=sqrt(v52)*Y52+mu52;g53=sqrt(v53)*Y53+mu53;g54=sqrt(v54)*Y54+mu54
  ##For generating samples from exponential distribution
  #Y11=rexp(n11,1);Y12=rexp(n12,1);Y13=rexp(n13,1);Y14=rexp(n14,1)
  #Y21=rexp(n21,1);Y22=rexp(n22,1);Y23=rexp(n23,1);Y24=rexp(n24,1)
  #Y31=rexp(n31,1);Y32=rexp(n32,1);Y33=rexp(n33,1);Y34=rexp(n34,1)
  #Y41=rexp(n41,1);Y42=rexp(n42,1);Y43=rexp(n43,1);Y44=rexp(n44,1)
  #Y51=rexp(n51,1);Y52=rexp(n52,1);Y53=rexp(n53,1);Y54=rexp(n54,1)
  #g11=mu11+sqrt(v11)*(Y11-1);g12=mu12+sqrt(v12)*(Y12-1);g13=mu13+sqrt(v13)*(Y13-1);g14=mu14+sqrt(v14)*(Y14-1)
  #g21=mu21+sqrt(v21)*(Y21-1);g22=mu22+sqrt(v22)*(Y22-1);g23=mu23+sqrt(v23)*(Y23-1);g24=mu24+sqrt(v24)*(Y24-1)
  #g31=mu31+sqrt(v31)*(Y31-1);g32=mu32+sqrt(v32)*(Y32-1);g33=mu33+sqrt(v33)*(Y33-1);g34=mu34+sqrt(v34)*(Y34-1)
  #g41=mu41+sqrt(v41)*(Y41-1);g42=mu42+sqrt(v42)*(Y42-1);g43=mu43+sqrt(v43)*(Y43-1);g44=mu44+sqrt(v44)*(Y44-1)
  #g51=mu51+sqrt(v51)*(Y51-1);g52=mu52+sqrt(v52)*(Y52-1);g53=mu53+sqrt(v53)*(Y53-1);g54=mu54+sqrt(v54)*(Y54-1)
  ##For generating samples from Gamma distribution
  #Y11=(rgamma(n11,2,1)-2)/sqrt(2);Y12=(rgamma(n12,2,1)-2)/sqrt(2);Y13=(rgamma(n13,2,1)-2)/sqrt(2);Y14=(rgamma(n14,2,1)-2)/sqrt(2)
  #Y21=(rgamma(n21,2,1)-2)/sqrt(2);Y22=(rgamma(n22,2,1)-2)/sqrt(2);Y23=(rgamma(n23,2,1)-2)/sqrt(2);Y24=(rgamma(n24,2,1)-2)/sqrt(2)
  #Y31=(rgamma(n31,2,1)-2)/sqrt(2);Y32=(rgamma(n32,2,1)-2)/sqrt(2);Y33=(rgamma(n33,2,1)-2)/sqrt(2);Y34=(rgamma(n34,2,1)-2)/sqrt(2)
  #Y41=(rgamma(n41,2,1)-2)/sqrt(2);Y42=(rgamma(n42,2,1)-2)/sqrt(2);Y43=(rgamma(n43,2,1)-2)/sqrt(2);Y44=(rgamma(n44,2,1)-2)/sqrt(2)
  #Y51=(rgamma(n51,2,1)-2)/sqrt(2);Y52=(rgamma(n52,2,1)-2)/sqrt(2);Y53=(rgamma(n53,2,1)-2)/sqrt(2);Y54=(rgamma(n54,2,1)-2)/sqrt(2)
  #g11=mu11+sqrt(v11)*Y11;g12=mu12+sqrt(v12)*Y12;g13=mu13+sqrt(v13)*Y13;g14=mu14+sqrt(v14)*Y14
  #g21=mu21+sqrt(v21)*Y21;g22=mu22+sqrt(v22)*Y22;g23=mu23+sqrt(v23)*Y23;g24=mu24+sqrt(v24)*Y24
  #g31=mu31+sqrt(v31)*Y31;g32=mu32+sqrt(v32)*Y32;g33=mu33+sqrt(v33)*Y33;g34=mu34+sqrt(v34)*Y34
  #g41=mu41+sqrt(v41)*Y41;g42=mu42+sqrt(v42)*Y42;g43=mu43+sqrt(v43)*Y43;g44=mu44+sqrt(v44)*Y44
  #g51=mu51+sqrt(v51)*Y51;g52=mu52+sqrt(v52)*Y52;g53=mu53+sqrt(v53)*Y53;g54=mu54+sqrt(v54)*Y54
  s11=var(g11);s12=var(g12);s13=var(g13);s14=var(g14)
  s21=var(g21);s22=var(g22);s23=var(g23);s24=var(g24)
  s31=var(g31);s32=var(g32);s33=var(g33);s34=var(g34)
  s41=var(g41);s42=var(g42);s43=var(g43);s44=var(g44)
  s51=var(g51);s52=var(g52);s53=var(g53);s54=var(g54)
  m11=mean(g11);m12=mean(g12);m13=mean(g13);m14=mean(g14)
  m21=mean(g21);m22=mean(g22);m23=mean(g23);m24=mean(g24)
  m31=mean(g31);m32=mean(g32);m33=mean(g33);m34=mean(g34)
  m41=mean(g41);m42=mean(g42);m43=mean(g43);m44=mean(g44)
  m51=mean(g51);m52=mean(g52);m53=mean(g53);m54=mean(g54)
  x1=(m11+m12+m13+m14)/4;x2=(m21+m22+m23+m24)/4;x3=(m31+m32+m33+m34)/4
  x4=(m41+m42+m43+m44)/4;x5=(m51+m52+m53+m54)/4
  y1=(m11+m21+m31+m41+m51)/5;y2=(m12+m22+m32+m42+m52)/5;y3=(m13+m23+m33+m43+m53)/5
  y4=(m14+m24+m34+m44+m54)/5
  m=(m11+m12+m13+m14+m21+m22+m23+m24+m31+m32+m33+m34+m41+m42+m43+m44+m51+m52+m53+m54)/20
  A1=c(x1,x2,x3,x4,x5);B1=c(y1-m,y2-m,y3-m,y4-m)
  u11=n11/s11;u12=n12/s12;u13=n13/s13;u14=n14/s14;u21=n21/s21;u22=n22/s22;u23=n23/s23;u24=n24/s24
  u31=n31/s31;u32=n32/s32;u33=n33/s33;u34=n34/s34;u41=n41/s41;u42=n42/s42;u43=n43/s43;u44=n44/s44
  u51=n51/s51;u52=n52/s52;u53=n53/s53;u54=n54/s54
  a10=(u11*(m11-B1[1])+u12*(m12-B1[2])+u13*(m13-B1[3])+u14*(m14-B1[4]))/(u11+u12+u13+u14)
  a11=(u21*(m21-B1[1])+u22*(m22-B1[2])+u23*(m23-B1[3])+u24*(m24-B1[4]))/(u21+u22+u23+u24)
  a12=(u31*(m31-B1[1])+u32*(m32-B1[2])+u33*(m33-B1[3])+u34*(m34-B1[4]))/(u31+u32+u33+u34)
  a13=(u41*(m41-B1[1])+u42*(m42-B1[2])+u43*(m43-B1[3])+u44*(m44-B1[4]))/(u41+u42+u43+u44)
  a14=(u51*(m51-B1[1])+u52*(m52-B1[2])+u53*(m53-B1[3])+u54*(m54-B1[4]))/(u51+u52+u53+u54)
  b10=(u11*(m11-a10)+u21*(m21-a11)+u31*(m31-a12)+u41*(m41-a13)+u51*(m51-a14))/(u11+u21+u31+u41+u51)
  b11=(u12*(m12-a10)+u22*(m22-a11)+u32*(m32-a12)+u42*(m42-a13)+u52*(m52-a14))/(u12+u22+u32+u42+u52)
  b12=(u13*(m13-a10)+u23*(m23-a11)+u33*(m33-a12)+u43*(m43-a13)+u53*(m53-a14))/(u13+u23+u33+u43+u53)
  b13=(u14*(m14-a10)+u24*(m24-a11)+u34*(m34-a12)+u44*(m44-a13)+u54*(m54-a14))/(u14+u24+u34+u44+u54)
  alpha0<-c(a10,a11,a12,a13,a14);beta0<-c(b10,b11,b12,b13)
  x14=alpha0;x15=beta0
  S11=sum((g11-x14[1]-x15[1])^2)/n11;S12=sum((g12-x14[1]-x15[2])^2)/n12
  S13=sum((g13-x14[1]-x15[3])^2)/n13;S14=sum((g14-x14[1]-x15[4])^2)/n14
  S21=sum((g21-x14[2]-x15[1])^2)/n21;S22=sum((g22-x14[2]-x15[2])^2)/n22
  S23=sum((g23-x14[2]-x15[3])^2)/n23;S24=sum((g24-x14[2]-x15[4])^2)/n24
  S31=sum((g31-x14[3]-x15[1])^2)/n31;S32=sum((g32-x14[3]-x15[2])^2)/n32
  S33=sum((g33-x14[3]-x15[3])^2)/n33;S34=sum((g34-x14[3]-x15[4])^2)/n34
  S41=sum((g41-x14[4]-x15[1])^2)/n41;S42=sum((g42-x14[4]-x15[2])^2)/n42
  S43=sum((g43-x14[4]-x15[3])^2)/n43;S44=sum((g44-x14[4]-x15[4])^2)/n44
  S51=sum((g51-x14[5]-x15[1])^2)/n51;S52=sum((g52-x14[5]-x15[2])^2)/n52
  S53=sum((g53-x14[5]-x15[3])^2)/n53;S54=sum((g54-x14[5]-x15[4])^2)/n54
  repeat
  {
    u11=n11/S11;u12=n12/S12;u13=n13/S13;u14=n14/S14;u21=n21/S21;u22=n22/S22;u23=n23/S23;u24=n24/S24
    u31=n31/S31;u32=n32/S32;u33=n33/S33;u34=n34/S34;u41=n41/S41;u42=n42/S42;u43=n43/S43;u44=n44/S44
    u51=n51/S51;u52=n52/S52;u53=n53/S53;u54=n54/S54
    w1=(u11+u12+u13+u14);w2=(u21+u22+u23+u24);w3=(u31+u32+u33+u34)
    w4=(u41+u42+u43+u44);w5=(u51+u52+u53+u54)
    #mu=(u11*x11.+u12*x12.+u13*x13.+u21*x21.+u22*x22.+u23*x23.+u31*x31.+u32*x32.+u33*x33.)/(w1+w2+w3)
    W=c(w1,w2,w3,w4,w5)
    X1=((u11*(m11-beta0[1]))+(u12*(m12-beta0[2]))+(u13*(m13-beta0[3]))+(u14*(m14-beta0[4])))/w1
    X2=((u21*(m21-beta0[1]))+(u22*(m22-beta0[2]))+(u23*(m23-beta0[3]))+(u24*(m24-beta0[4])))/w2
    X3=((u31*(m31-beta0[1]))+(u32*(m32-beta0[2]))+(u33*(m33-beta0[3]))+(u34*(m34-beta0[4])))/w3
    X4=((u41*(m41-beta0[1]))+(u42*(m42-beta0[2]))+(u43*(m43-beta0[3]))+(u44*(m44-beta0[4])))/w4
    X5=((u51*(m51-beta0[1]))+(u52*(m52-beta0[2]))+(u53*(m53-beta0[3]))+(u54*(m54-beta0[4])))/w5
    X=c(X1,X2,X3,X4,X5)
    alpha1=pava(X,W)
    w4=(u11+u21+u31+u41+u51);w5=(u12+u22+u32+u42+u52);w6=(u13+u23+u33+u43+u53);w7=(u14+u24+u34+u44+u54)
    B1=((u11*(m11-alpha1[1]))+(u21*(m21-alpha1[2]))+(u31*(m31-alpha1[3]))+(u41*(m41-alpha1[4]))+(u51*(m51-alpha1[5])))/w4
    B2=((u12*(m12-alpha1[1]))+(u22*(m22-alpha1[2]))+(u32*(m32-alpha1[3]))+(u42*(m42-alpha1[4]))+(u52*(m52-alpha1[5])))/w5
    B3=((u13*(m13-alpha1[1]))+(u23*(m23-alpha1[2]))+(u33*(m33-alpha1[3]))+(u43*(m43-alpha1[4]))+(u53*(m53-alpha1[5])))/w6
    B4=((u14*(m14-alpha1[1]))+(u24*(m24-alpha1[2]))+(u34*(m34-alpha1[3]))+(u44*(m44-alpha1[4]))+(u54*(m54-alpha1[5])))/w7
    beta1=c(B1,B2,B3,B4)
    S111=sum((g11-alpha1[1]-beta1[1])^2)/n11;S112=sum((g12-alpha1[1]-beta1[2])^2)/n12
    S113=sum((g13-alpha1[1]-beta1[3])^2)/n13;S114=sum((g14-alpha1[1]-beta1[4])^2)/n14
    S121=sum((g21-alpha1[2]-beta1[1])^2)/n21;S122=sum((g22-alpha1[2]-beta1[2])^2)/n22
    S123=sum((g23-alpha1[2]-beta1[3])^2)/n23;S124=sum((g24-alpha1[2]-beta1[4])^2)/n24
    S131=sum((g31-alpha1[3]-beta1[1])^2)/n31;S132=sum((g32-alpha1[3]-beta1[2])^2)/n32
    S133=sum((g33-alpha1[3]-beta1[3])^2)/n33;S134=sum((g34-alpha1[3]-beta1[4])^2)/n34
    S141=sum((g41-alpha1[4]-beta1[1])^2)/n41;S142=sum((g42-alpha1[4]-beta1[2])^2)/n42
    S143=sum((g43-alpha1[4]-beta1[3])^2)/n43;S144=sum((g44-alpha1[4]-beta1[4])^2)/n44
    S151=sum((g51-alpha1[5]-beta1[1])^2)/n51;S152=sum((g52-alpha1[5]-beta1[2])^2)/n52
    S153=sum((g53-alpha1[5]-beta1[3])^2)/n53;S154=sum((g54-alpha1[5]-beta1[4])^2)/n54
    M=max(abs(x14-alpha1));N=max(abs(x15-beta1))
    if(M<=0.0000001 & N<=0.0000001)
    {
      break
    }
    S11=S111;S12=S112;S13=S113;S14=S114;S21=S121;S22=S122;S23=S123;S24=S124
    S31=S131;S32=S132;S33=S133;S34=S134;S41=S141;S42=S142;S43=S143;S44=S144
    S51=S151;S52=S152;S53=S153;S54=S154
    x14=alpha1;x15=beta1
  }
  u11=n11/s11;u12=n12/s12;u13=n13/s13;u14=n14/s14;u21=n21/s21;u22=n22/s22;u23=n23/s23;u24=n24/s24
  u31=n31/s31;u32=n32/s32;u33=n33/s33;u34=n34/s34;u41=n41/s41;u42=n42/s42;u43=n43/s43;u44=n44/s44
  u51=n51/s51;u52=n52/s52;u53=n53/s53;u54=n54/s54
  U.1=u11+u21+u31+u41+u51;U.2=u12+u22+u32+u42+u52;U.3=u13+u23+u33+u43+u53;U.4=u14+u24+u34+u44+u54
  beta01=c((u11*m11+u21*m21+u31*m31+u41*m41+u51*m51)/U.1,(u12*m12+u22*m22+u32*m32+u42*m42+u52*m52)/U.2,
           (u13*m13+u23*m23+u33*m33+u43*m43+u53*m53)/U.3,(u14*m14+u24*m24+u34*m34+u44*m44+u54*m54)/U.4)
  x16=beta01
  V11=sum((g11-x16[1])^2)/n11;V12=sum((g12-x16[2])^2)/n12
  V13=sum((g13-x16[3])^2)/n13;V14=sum((g14-x16[4])^2)/n14
  V21=sum((g21-x16[1])^2)/n21;V22=sum((g22-x16[2])^2)/n22
  V23=sum((g23-x16[3])^2)/n23;V24=sum((g24-x16[4])^2)/n24
  V31=sum((g31-x16[1])^2)/n31;V32=sum((g32-x16[2])^2)/n32
  V33=sum((g33-x16[3])^2)/n33;V34=sum((g34-x16[4])^2)/n34
  V41=sum((g41-x16[1])^2)/n41;V42=sum((g42-x16[2])^2)/n42
  V43=sum((g43-x16[3])^2)/n43;V44=sum((g44-x16[4])^2)/n44
  V51=sum((g51-x16[1])^2)/n51;V52=sum((g52-x16[2])^2)/n52
  V53=sum((g53-x16[3])^2)/n53;V54=sum((g54-x16[4])^2)/n54
  repeat
  {
    u11=n11/V11;u12=n12/V12;u13=n13/V13;u14=n14/V14;u21=n21/V21;u22=n22/V22;u23=n23/V23;u24=n24/V24
    u31=n31/V31;u32=n32/V32;u33=n33/V33;u34=n34/V34;u41=n41/V41;u42=n42/V42;u43=n43/V43;u44=n44/V44
    u51=n51/V51;u52=n52/V52;u53=n53/V53;u54=n54/V54
    U.1=u11+u21+u31+u41+u51;U.2=u12+u22+u32+u42+u52;U.3=u13+u23+u33+u43+u53;U.4=u14+u24+u34+u44+u54
    beta11=c((u11*m11+u21*m21+u31*m31+u41*m41+u51*m51)/U.1,(u12*m12+u22*m22+u32*m32+u42*m42+u52*m52)/U.2,
             (u13*m13+u23*m23+u33*m33+u43*m43+u53*m53)/U.3,(u14*m14+u24*m24+u34*m34+u44*m44+u54*m54)/U.4)
    dif=max(abs(x16-beta11))
    if(dif<=0.00001)
    {
      break
    }
    S011=sum((g11-beta11[1])^2)/n11;S012=sum((g12-beta11[2])^2)/n12
    S013=sum((g13-beta11[3])^2)/n13;S014=sum((g14-beta11[4])^2)/n14
    S021=sum((g21-beta11[1])^2)/n21;S022=sum((g22-beta11[2])^2)/n22
    S023=sum((g23-beta11[3])^2)/n23;S024=sum((g24-beta11[4])^2)/n24
    S031=sum((g31-beta11[1])^2)/n31;S032=sum((g32-beta11[2])^2)/n32
    S033=sum((g33-beta11[3])^2)/n33;S034=sum((g34-beta11[4])^2)/n34
    S041=sum((g41-beta11[1])^2)/n41;S042=sum((g42-beta11[2])^2)/n42
    S043=sum((g43-beta11[3])^2)/n43;S044=sum((g44-beta11[4])^2)/n44
    S051=sum((g51-beta11[1])^2)/n51;S052=sum((g52-beta11[2])^2)/n52
    S053=sum((g53-beta11[3])^2)/n53;S054=sum((g54-beta11[4])^2)/n54
    V11=S011;V12=S012;V13=S013;V14=S014;V21=S021;V22=S022;V23=S023;V24=S024
    V31=S031;V32=S032;V33=S033;V34=S034;V41=S041;V42=S042;V43=S043;V44=S044
    V51=S051;V52=S052;V53=S053;V54=S054
    x16=beta11
  }
  neu=(S111^(n11/2))*(S112^(n12/2))*(S113^(n13/2))*(S114^(n14/2))*(S121^(n21/2))*(S122^(n22/2))*(S123^(n23/2))*(S124^(n24/2))*
    (S131^(n31/2))*(S132^(n32/2))*(S133^(n33/2))*(S134^(n34/2))*(S141^(n41/2))*(S142^(n42/2))*(S143^(n43/2))*(S144^(n44/2))*
    (S151^(n51/2))*(S152^(n52/2))*(S153^(n53/2))*(S154^(n54/2))

  dno=(S011^(n11/2))*(S012^(n12/2))*(S013^(n13/2))*(S014^(n14/2))*(S021^(n21/2))*(S022^(n22/2))*(S023^(n23/2))*(S024^(n24/2))*
    (S031^(n31/2))*(S032^(n32/2))*(S033^(n33/2))*(S034^(n34/2))*(S041^(n41/2))*(S042^(n42/2))*(S043^(n43/2))*(S044^(n44/2))*
    (S051^(n51/2))*(S052^(n52/2))*(S053^(n53/2))*(S054^(n54/2))

  value=neu/dno
  out<-fun2(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
            s11,s12,s13,s14,s21,s22,s23,s24,s31,s32,s33,s34,s41,s42,s43,s44,s51,s52,s53,s54)
  a=0
  if(value<out)
    a=a+1
  return(a)
}
fun4<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
               mu11,mu12,mu13,mu14,mu21,mu22,mu23,mu24,mu31,mu32,mu33,mu34,mu41,mu42,mu43,mu44,
               mu51,mu52,mu53,mu54,
               v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54)
{
  out<-replicate(1000,fun3(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44,n51,n52,n53,n54,
                           mu11,mu12,mu13,mu14,mu21,mu22,mu23,mu24,mu31,mu32,mu33,mu34,mu41,mu42,mu43,mu44,
                           mu51,mu52,mu53,mu54,
                           v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34,v41,v42,v43,v44,v51,v52,v53,v54))
  value<-mean(out)
  return(value)
}

X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                      0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,
                   0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2))
mean(X)
X=replicate(4,fun4(10,10,10,10,8,8,8,8,12,12,12,12,14,14,14,14,15,15,15,15,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,
                   0.6,0.6,0.6,0.6,0.8,0.8,0.8,0.8,2,2,2,2,1.5,1.5,1.5,1.5))
mean(X)

X=replicate(4,fun4(10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4))
mean(X)
X=replicate(4,fun4(10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,
                   0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1))
mean(X)
X=replicate(4,fun4(10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2))
mean(X)
X=replicate(4,fun4(10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,10,15,18,20,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,
                   0.6,0.6,0.6,0.6,0.8,0.8,0.8,0.8,2,2,2,2,1.5,1.5,1.5,1.5))
mean(X)

X=replicate(4,fun4(10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4))
mean(X)
X=replicate(4,fun4(10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,
                   0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1))
mean(X)
X=replicate(4,fun4(10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2))
mean(X)
X=replicate(4,fun4(10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,
                   0.6,0.6,0.6,0.6,0.8,0.8,0.8,0.8,2,2,2,2,1.5,1.5,1.5,1.5))
mean(X)

X=replicate(4,fun4(10,8,9,15,16,17,10,16,8,10,12,14,15,17,8,9,10,12,13,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4,0.1,0.2,0.3,0.4))
mean(X)
X=replicate(4,fun4(10,8,9,15,16,17,10,16,8,10,12,14,15,17,8,9,10,12,13,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0.1,
                   0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1))
mean(X)
X=replicate(4,fun4(10,8,9,15,16,17,10,16,8,10,12,14,15,17,8,9,10,12,13,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.2,0.3,0.4,
                   0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2))
mean(X)
X=replicate(4,fun4(10,8,9,15,16,17,10,16,8,10,12,14,15,17,8,9,10,12,13,10,
                   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,
                   0.6,0.6,0.6,0.6,0.8,0.8,0.8,0.8,2,2,2,2,1.5,1.5,1.5,1.5))
mean(X)

