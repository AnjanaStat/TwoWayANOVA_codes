rm(list=ls())
library(Iso)


fun1<-function(n11,n12,n13,n21,n22,n23,n31,n32,n33,v11,v12,v13,v21,v22,v23,v31,v32,v33)
{
  g11<-rnorm(n11,0,sqrt(v11));g12<-rnorm(n12,0,sqrt(v12));g13<-rnorm(n13,0,sqrt(v13))
  g21<-rnorm(n21,0,sqrt(v21));g22<-rnorm(n22,0,sqrt(v22));g23<-rnorm(n23,0,sqrt(v23))
  g31<-rnorm(n31,0,sqrt(v31));g32<-rnorm(n32,0,sqrt(v32));g33<-rnorm(n33,0,sqrt(v33))
  s11=var(g11);s12=var(g12);s13=var(g13);s21=var(g21);s22=var(g22);s23=var(g23)
  s31=var(g31);s32=var(g32);s33=var(g33)
  m11=mean(g11);m12=mean(g12);m13=mean(g13)
  m21=mean(g21);m22=mean(g22);m23=mean(g23)
  m31=mean(g31);m32=mean(g32);m33=mean(g33)
  x1=(m11+m12+m13)/3;x2=(m21+m22+m23)/3;x3=(m31+m32+m33)/3
  y1=(m11+m21+m31)/3;y2=(m12+m22+m32)/3;y3=(m13+m23+m33)/3
  m=(m11+m12+m13+m21+m22+m23+m31+m32+m33)/9
  a=c(x1,x2,x3);b=c(y1-m,y2-m,y3-m)
  x14=a;x15=b
  S11=s11;S12=s12;S13=s13;S21=s21;S22=s22;S23=s23;S31=s31;S32=s32;S33=s33
  #c(S11,S12,S13,S21,S22,S23,S31,S32,S33)
  #sum((g11-x14[1]-x15[1])^2)/n11;S12=sum((g12-x14[1]-x15[2])^2)/n12
  #S21=sum((g21-x14[2]-x15[1])^2)/n21;S22=sum((g22-x14[2]-x15[2])^2)/n22
  repeat
  {
    u11=n11/S11;u12=n12/S12;u13=n13/S13;u21=n21/S21;u22=n22/S22;u23=n23/S23
    u31=n31/S31;u32=n32/S32;u33=n33/S33
    u.1=(u11+u21+u31);u.2=(u12+u22+u32);u.3=(u13+u23+u33)
    a10=((u11*m11+u12*m12+u13*m13)+(u13-u11)*x15[1]+(u13-u12)*x15[2])/(u11+u12+u13)
    a11=((u21*m21+u22*m22+u23*m23)+(u23-u21)*x15[1]+(u23-u22)*x15[2])/(u21+u22+u23)
    a13=((u31*m31+u32*m32+u33*m33)+(u33-u31)*x15[1]+(u33-u32)*x15[2])/(u31+u32+u33)
    w1=u11+u12+u13;w2=u21+u22+u23;w3=u31+u32+u33
    alpha0<-c(a10,a11,a13)
    w=c(w1,w2,w3)
    alpha1=pava(alpha0,w)
    q=u13*(m13-alpha1[1])+u23*(m23-alpha1[2])+u33*(m33-alpha1[3])
    v1=(u11*(m11-alpha1[1])+u21*(m21-alpha1[2])+u31*(m31-alpha1[3]))-q
    v2=(u12*(m12-alpha1[1])+u22*(m22-alpha1[2])+u32*(m32-alpha1[3]))-q
    #v3=(u13*(m13-alpha1[1])+u23*(m23-alpha1[2])+u33*(m33-alpha1[3]))-q
    v=matrix(c(v1,v2),nrow=2,ncol=1,byrow=TRUE)
    A.data=c(u.1+u.3,u.3,u.3,u.3+u.2)
    A=matrix(A.data,nrow=2,ncol=2,byrow=TRUE)
    bn=solve(A)%*%v
    bn3=-(bn[1]+bn[2])
    beta=c(bn[1],bn[2],bn3)
    S111=sum((g11-alpha1[1]-beta[1])^2)/n11;S112=sum((g12-alpha1[1]-beta[2])^2)/n12
    S113=sum((g13-alpha1[1]-beta[3])^2)/n13
    S121=sum((g21-alpha1[2]-beta[1])^2)/n21;S122=sum((g22-alpha1[2]-beta[2])^2)/n22
    S123=sum((g23-alpha1[2]-beta[3])^2)/n23
    S131=sum((g31-alpha1[3]-beta[1])^2)/n31;S132=sum((g32-alpha1[3]-beta[2])^2)/n32
    S133=sum((g33-alpha1[3]-beta[3])^2)/n33
    M=max(abs(x14-alpha1));N=max(abs(x15-beta))
    if(M<=0.0000001 & N<=0.0000001)
    {
      break
    }
    S11=S111;S12=S112;S13=S113;S21=S121;S22=S122;S23=S123;S31=S131;S32=S132;S33=S133
    x14=alpha1;x15=beta
  }
  u11=n11/s11;u12=n12/s12;u13=n13/s13;u21=n21/s21;u22=n22/s22;u23=n23;u31=n31/s31;u32=n32/s32;u33=n33/s33
  U.1=u11+u21+u31;U.2=u12+u22+u32;U.3=u13+u23+u33
  beta01=c((u11*m11+u21*m21+u31*m31)/U.1,(u12*m12+u22*m22+u32*m32)/U.2,(u13*m13+u23*m23+u33*m33)/U.3)
  x16=beta01
  s011=sum((g11-x16[1])^2)/n11;s012=sum((g12-x16[2])^2)/n12;s013=sum((g13-x16[3])^2)/n13
  s021=sum((g21-x16[1])^2)/n21;s022=sum((g22-x16[2])^2)/n22;s023=sum((g23-x16[3])^2)/n23
  s031=sum((g31-x16[1])^2)/n31;s032=sum((g32-x16[2])^2)/n32;s033=sum((g33-x16[3])^2)/n33
  repeat
  {
    u11=n11/s011;u12=n12/s012;u13=n13/s013;u21=n21/s021;u22=n22/s022;u23=n23/s023
    u31=n31/s031;u32=n32/s032;u33=n33/s033
    U.1=u11+u21+u31;U.2=u12+u22+u32;U.3=u13+u23+u33
    beta11=c((u11*m11+u21*m21+u31*m31)/U.1,(u12*m12+u22*m22+u32*m32)/U.2,(u13*m13+u23*m23+u33*m33)/U.3)
    dif=max(abs(x16-beta11))
    if(dif<=0.00001)
    {
      break
    }
    S011=sum((g11-beta11[1])^2)/n11;S012=sum((g12-beta11[2])^2)/n12;S013=sum((g13-beta11[3])^2)/n13
    S021=sum((g21-beta11[1])^2)/n21;S022=sum((g22-beta11[2])^2)/n22;S023=sum((g23-beta11[3])^2)/n23
    S031=sum((g31-beta11[1])^2)/n31;S032=sum((g32-beta11[2])^2)/n32;S033=sum((g33-beta11[3])^2)/n33
    s011=S011;s012=S012;s013=S013;s021=S021;s022=S022;s023=S023;s031=S031;s032=S032;s033=S033
    x16=beta11
  }
  #neu=(S111^(n11/2))*(S112^(n12/2))*(S121^(n21/2))*(S122^(n22/2))*(S131^(n31/2))*(S132^(n32/2))
  #dno=(s011^(n11/2))*(s012^(n12/2))*(s021^(n21/2))*(s022^(n22/2))*(s031^(n31/2))*(s032^(n32/2))
  #value=neu/dno
  value=(S111/s011)^(n11/2)*(S112/s012)^(n12/2)*(S113/s013)^(n13/2)*(S121/s021)^(n21/2)*
    (S122/s022)^(n22/2)*(S123/s023)^(n23/2)*(S131/s031)^(n31/2)*(S132/s032)^(n32/2)*(S133/s033)^(n33/2)
  return(value)
}
#X=replicate(1000,fun1(10,10,10,20,15,15,10,20,20,1,1,1.5,1,1,1.5,2,1,1))
#plot(X)
fun2<-function(n11,n12,n13,n21,n22,n23,n31,n32,n33,v11,v12,v13,v21,v22,v23,v31,v32,v33)
{
  x=replicate(1000,fun1(n11,n12,n13,n21,n22,n23,n31,n32,n33,v11,v12,v13,v21,v22,v23,v31,v32,v33))
  y<-sort(x,decreasing=FALSE)
  c<-y[50]
  return(c)
}

fun3<-function(mu11,mu12,mu13,mu21,mu22,mu23,mu31,mu32,mu33,n11,n12,n13,n21,n22,n23,n31,n32,n33,v11,
               v12,v13,v21,v22,v23,v31,v32,v33)
{
  g11<-rnorm(n11,mu11,sqrt(v11));g12<-rnorm(n12,mu12,sqrt(v12))
  g13<-rnorm(n13,mu13,sqrt(v13))
  g21<-rnorm(n21,mu21,sqrt(v21));g22<-rnorm(n22,mu22,sqrt(v22))
  g23<-rnorm(n23,mu23,sqrt(v23))
  g31<-rnorm(n31,mu31,sqrt(v31));g32<-rnorm(n32,mu32,sqrt(v32))
  g33<-rnorm(n33,mu33,sqrt(v33))
  #Y11=rt(n11,3,ncp=0)/sqrt(3);Y12=rt(n12,3,ncp=0)/sqrt(3);Y13=rt(n13,3,ncp=0)/sqrt(3)
  #Y21=rt(n21,3,ncp=0)/sqrt(3);Y22=rt(n22,3,ncp=0)/sqrt(3);Y23=rt(n23,3,ncp=0)/sqrt(3)
  #Y31=rt(n31,3,ncp=0)/sqrt(3);Y32=rt(n32,3,ncp=0)/sqrt(3);Y33=rt(n33,3,ncp=0)/sqrt(3)
  #g11=sqrt(v11)*Y11+mu11;g12=sqrt(v12)*Y12+mu12;g13=sqrt(v13)*Y13+mu13
  #g21=sqrt(v21)*Y21+mu21;g22=sqrt(v22)*Y22+mu22;g23=sqrt(v23)*Y23+mu23
  #g31=sqrt(v31)*Y31+mu31;g32=sqrt(v32)*Y32+mu32;g33=sqrt(v33)*Y33+mu33
  s11=var(g11);s12=var(g12);s13=var(g13);s21=var(g21);s22=var(g22);s23=var(g23)
  s31=var(g31);s32=var(g32);s33=var(g33)
  m11=mean(g11);m12=mean(g12);m13=mean(g13)
  m21=mean(g21);m22=mean(g22);m23=mean(g23)
  m31=mean(g31);m32=mean(g32);m33=mean(g33)
  x1=(m11+m12+m13)/3;x2=(m21+m22+m23)/3;x3=(m31+m32+m33)/3
  y1=(m11+m21+m31)/3;y2=(m12+m22+m32)/3;y3=(m13+m23+m33)/3
  m=(m11+m12+m13+m21+m22+m23+m31+m32+m33)/9
  a=c(x1,x2,x3);b=c(y1-m,y2-m,y3-m)
  x14=a;x15=b
  S11=s11;S12=s12;S13=s13;S21=s21;S22=s22;S23=s23;S31=s31;S32=s32;S33=s33
  c(S11,S12,S13,S21,S22,S23,S31,S32,S33)
  #sum((g11-x14[1]-x15[1])^2)/n11;S12=sum((g12-x14[1]-x15[2])^2)/n12
  #S21=sum((g21-x14[2]-x15[1])^2)/n21;S22=sum((g22-x14[2]-x15[2])^2)/n22
  repeat
  {
    u11=n11/S11;u12=n12/S12;u13=n13/S13;u21=n21/S21;u22=n22/S22;u23=n23/S23
    u31=n31/S31;u32=n32/S32;u33=n33/S33
    u.1=(u11+u21+u31);u.2=(u12+u22+u32);u.3=(u13+u23+u33)
    a10=((u11*m11+u12*m12+u13*m13)+(u13-u11)*x15[1]+(u13-u12)*x15[2])/(u11+u12+u13)
    a11=((u21*m21+u22*m22+u23*m23)+(u23-u21)*x15[1]+(u23-u22)*x15[2])/(u21+u22+u23)
    a13=((u31*m31+u32*m32+u33*m33)+(u33-u31)*x15[1]+(u33-u32)*x15[2])/(u31+u32+u33)
    w1=u11+u12+u13;w2=u21+u22+u23;w3=u31+u32+u33
    alpha0<-c(a10,a11,a13)
    w=c(w1,w2,w3)
    alpha1=pava(alpha0,w)
    q=u13*(m13-alpha1[1])+u23*(m23-alpha1[2])+u33*(m33-alpha1[3])
    v1=(u11*(m11-alpha1[1])+u21*(m21-alpha1[2])+u31*(m31-alpha1[3]))-q
    v2=(u12*(m12-alpha1[1])+u22*(m22-alpha1[2])+u32*(m32-alpha1[3]))-q
    #v3=(u13*(m13-alpha1[1])+u23*(m23-alpha1[2])+u33*(m33-alpha1[3]))-q
    v=matrix(c(v1,v2),nrow=2,ncol=1,byrow=TRUE)
    A.data=c(u.1+u.3,u.3,u.3,u.3+u.2)
    A=matrix(A.data,nrow=2,ncol=2,byrow=TRUE)
    bn=solve(A)%*%v
    bn3=-(bn[1]+bn[2])
    beta=c(bn[1],bn[2],bn3)
    S111=sum((g11-alpha1[1]-beta[1])^2)/n11;S112=sum((g12-alpha1[1]-beta[2])^2)/n12
    S113=sum((g13-alpha1[1]-beta[3])^2)/n13
    S121=sum((g21-alpha1[2]-beta[1])^2)/n21;S122=sum((g22-alpha1[2]-beta[2])^2)/n22
    S123=sum((g23-alpha1[2]-beta[3])^2)/n23
    S131=sum((g31-alpha1[3]-beta[1])^2)/n31;S132=sum((g32-alpha1[3]-beta[2])^2)/n32
    S133=sum((g33-alpha1[3]-beta[3])^2)/n33
    M=max(abs(x14-alpha1));N=max(abs(x15-beta))
    if(M<=0.0000001 & N<=0.0000001)
    {
      break
    }
    S11=S111;S12=S112;S13=S113;S21=S121;S22=S122;S23=S123;S31=S131;S32=S132;S33=S133
    x14=alpha1;x15=beta
  }
  u11=n11/s11;u12=n12/s12;u13=n13/s13;u21=n21/s21;u22=n22/s22;u23=n23;u31=n31/s31;u32=n32/s32;u33=n33/s33
  U.1=u11+u21+u31;U.2=u12+u22+u32;U.3=u13+u23+u33
  beta01=c((u11*m11+u21*m21+u31*m31)/U.1,(u12*m12+u22*m22+u32*m32)/U.2,(u13*m13+u23*m23+u33*m33)/U.3)
  x16=beta01
  s011=sum((g11-x16[1])^2)/n11;s012=sum((g12-x16[2])^2)/n12;s013=sum((g13-x16[3])^2)/n13
  s021=sum((g21-x16[1])^2)/n21;s022=sum((g22-x16[2])^2)/n22;s023=sum((g23-x16[3])^2)/n23
  s031=sum((g31-x16[1])^2)/n31;s032=sum((g32-x16[2])^2)/n32;s033=sum((g33-x16[3])^2)/n33
  repeat
  {
    u11=n11/s011;u12=n12/s012;u13=n13/s013;u21=n21/s021;u22=n22/s022;u23=n23/s023
    u31=n31/s031;u32=n32/s032;u33=n33/s033
    U.1=u11+u21+u31;U.2=u12+u22+u32;U.3=u13+u23+u33
    beta11=c((u11*m11+u21*m21+u31*m31)/U.1,(u12*m12+u22*m22+u32*m32)/U.2,(u13*m13+u23*m23+u33*m33)/U.3)
    dif=max(abs(x16-beta11))
    if(dif<=0.00001)
    {
      break
    }
    S011=sum((g11-beta11[1])^2)/n11;S012=sum((g12-beta11[2])^2)/n12;S013=sum((g13-beta11[3])^2)/n13
    S021=sum((g21-beta11[1])^2)/n21;S022=sum((g22-beta11[2])^2)/n22;S023=sum((g23-beta11[3])^2)/n23
    S031=sum((g31-beta11[1])^2)/n31;S032=sum((g32-beta11[2])^2)/n32;S033=sum((g33-beta11[3])^2)/n33
    s011=S011;s012=S012;s013=S013;s021=S021;s022=S022;s023=S023;s031=S031;s032=S032;s033=S033
    x16=beta11
  }
  #neu=(S111^(n11/2))*(S112^(n12/2))*(S121^(n21/2))*(S122^(n22/2))*(S131^(n31/2))*(S132^(n32/2))
  #dno=(s011^(n11/2))*(s012^(n12/2))*(s021^(n21/2))*(s022^(n22/2))*(s031^(n31/2))*(s032^(n32/2))
  #value=neu/dno
  value=(S111/s011)^(n11/2)*(S112/s012)^(n12/2)*(S113/s013)^(n13/2)*(S121/s021)^(n21/2)*
    (S122/s022)^(n22/2)*(S123/s023)^(n23/2)*(S131/s031)^(n31/2)*(S132/s032)^(n32/2)*(S133/s033)^(n33/2)
  out<-fun2(n11,n12,n13,n21,n22,n23,n31,n32,n33,s11,s12,s13,s21,s22,s23,s31,s32,s33)
  a=0
  if(value<out)
    a=a+1
  return(a)
}
fun4<-function(mu11,mu12,mu13,mu21,mu22,mu23,mu31,mu32,mu33,n11,n12,n13,n21,n22,n23,n31,n32,n33,v11,
               v12,v13,v21,v22,v23,v31,v32,v33)
{
  X=replicate(1000,fun3(mu11,mu12,mu13,mu21,mu22,mu23,mu31,mu32,mu33,n11,n12,n13,n21,n22,n23,n31,n32,n33,v11,
                        v12,v13,v21,v22,v23,v31,v32,v33))
  c=mean(X)
  return(c)
}



p<-replicate(3,fun4(0,0,0,0,0,0,0,0,0,10,10,10,15,15,15,20,20,20,
                    0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1,-0.1,-0.1,-0.05,-0.05,-0.05,0.15,0.15,0.15,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*1.2,-0.1*1.2,-0.1*1.2,-0.05*1.2,-0.05*1.2,-0.05*1.2,0.15*1.2,0.15*1.2,0.15*1.2,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*1.4,-0.1*1.4,-0.1*1.4,-0.05*1.4,-0.05*1.4,-0.05*1.4,0.15*1.4,0.15*1.4,0.15*1.4,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*1.6,-0.1*1.6,-0.1*1.6,-0.05*1.6,-0.05*1.6,-0.05*1.6,0.15*1.6,0.15*1.6,0.15*1.6,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*1.8,-0.1*1.8,-0.1*1.8,-0.05*1.8,-0.05*1.8,-0.05*1.8,0.15*1.8,0.15*1.8,0.15*1.8,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*2,-0.1*2,-0.1*2,-0.05*2,-0.05*2,-0.05*2,0.15*2,0.15*2,0.15*2,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*2.2,-0.1*2.2,-0.1*2.2,-0.05*2.2,-0.05*2.2,-0.05*2.2,0.15*2.2,0.15*2.2,0.15*2.2,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*2.4,-0.1*2.4,-0.1*2.4,-0.05*2.4,-0.05*2.4,-0.05*2.4,0.15*2.4,0.15*2.4,0.15*2.4,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*2.6,-0.1*2.6,-0.1*2.6,-0.05*2.6,-0.05*2.6,-0.05*2.6,0.15*2.6,0.15*2.6,0.15*2.6,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*2.8,-0.1*2.8,-0.1*2.8,-0.05*2.8,-0.05*2.8,-0.05*2.8,0.15*2.8,0.15*2.8,0.15*2.8,
                    8,8,4,4,6,6,15,15,10,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*3,-0.1*3,-0.1*3,-0.05*3,-0.05*3,-0.05*3,0.15*3,0.15*3,0.15*3,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*3.2,-0.1*3.2,-0.1*3.2,-0.05*3.2,-0.05*3.2,-0.05*3.2,0.15*3.2,0.15*3.2,0.15*3.2,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*3.4,-0.1*3.4,-0.1*3.4,-0.05*3.4,-0.05*3.4,-0.05*3.4,0.15*3.4,0.15*3.4,0.15*3.4,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*3.6,-0.1*3.6,-0.1*3.6,-0.05*3.6,-0.05*3.6,-0.05*3.6,0.15*3.6,0.15*3.6,0.15*3.6,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*3.8,-0.1*3.8,-0.1*3.8,-0.05*3.8,-0.05*3.8,-0.05*3.8,0.15*3.8,0.15*3.8,0.15*3.8,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*4,-0.1*4,-0.1*4,-0.05*4,-0.05*4,-0.05*4,0.15*4,0.15*4,0.15*4,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*4.2,-0.1*4.2,-0.1*4.2,-0.05*4.2,-0.05*4.2,-0.05*4.2,0.15*4.2,0.15*4.2,0.15*4.2,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*4.4,-0.1*4.4,-0.1*4.4,-0.05*4.4,-0.05*4.4,-0.05*4.4,0.15*4.4,0.15*4.4,0.15*4.4,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*4.6,-0.1*4.6,-0.1*4.6,-0.05*4.6,-0.05*4.6,-0.05*4.6,0.15*4.6,0.15*4.6,0.15*4.6,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*4.8,-0.1*4.8,-0.1*4.8,-0.05*4.8,-0.05*4.8,-0.05*4.8,0.15*4.8,0.15*4.8,0.15*4.8,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*5,-0.1*5,-0.1*5,-0.05*5,-0.05*5,-0.05*5,0.15*5,0.15*5,0.15*5,
                    10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,0.5,1))
alpha<-mean(p);alpha



p<-replicate(3,fun4(0,0,0,0,0,0,0,0,0,10,10,10,15,15,15,20,20,20,
                    0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1,-0.1,-0.1,-0.05,-0.05,-0.05,0.15,0.15,0.15,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*1.2,-0.1*1.2,-0.1*1.2,-0.05*1.2,-0.05*1.2,-0.05*1.2,0.15*1.2,0.15*1.2,0.15*1.2,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*1.4,-0.1*1.4,-0.1*1.4,-0.05*1.4,-0.05*1.4,-0.05*1.4,0.15*1.4,0.15*1.4,0.15*1.4,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*1.6,-0.1*1.6,-0.1*1.6,-0.05*1.6,-0.05*1.6,-0.05*1.6,0.15*1.6,0.15*1.6,0.15*1.6,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*1.8,-0.1*1.8,-0.1*1.8,-0.05*1.8,-0.05*1.8,-0.05*1.8,0.15*1.8,0.15*1.8,0.15*1.8,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*2,-0.1*2,-0.1*2,-0.05*2,-0.05*2,-0.05*2,0.15*2,0.15*2,0.15*2,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*2.2,-0.1*2.2,-0.1*2.2,-0.05*2.2,-0.05*2.2,-0.05*2.2,0.15*2.2,0.15*2.2,0.15*2.2,
                    8,8,4,4,6,6,15,15,10,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*2.4,-0.1*2.4,-0.1*2.4,-0.05*2.4,-0.05*2.4,-0.05*2.4,0.15*2.4,0.15*2.4,0.15*2.4,
                    8,8,4,4,6,6,15,15,10,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*2.6,-0.1*2.6,-0.1*2.6,-0.05*2.6,-0.05*2.6,-0.05*2.6,0.15*2.6,0.15*2.6,0.15*2.6,
                    8,8,4,4,6,6,15,15,10,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*2.8,-0.1*2.8,-0.1*2.8,-0.05*2.8,-0.05*2.8,-0.05*2.8,0.15*2.8,0.15*2.8,0.15*2.8,
                    8,8,4,4,6,6,15,15,10,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*3,-0.1*3,-0.1*3,-0.05*3,-0.05*3,-0.05*3,0.15*3,0.15*3,0.15*3,
                    8,8,4,4,6,6,15,15,10,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*3.2,-0.1*3.2,-0.1*3.2,-0.05*3.2,-0.05*3.2,-0.05*3.2,0.15*3.2,0.15*3.2,0.15*3.2,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*3.4,-0.1*3.4,-0.1*3.4,-0.05*3.4,-0.05*3.4,-0.05*3.4,0.15*3.4,0.15*3.4,0.15*3.4,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*3.6,-0.1*3.6,-0.1*3.6,-0.05*3.6,-0.05*3.6,-0.05*3.6,0.15*3.6,0.15*3.6,0.15*3.6,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*3.8,-0.1*3.8,-0.1*3.8,-0.05*3.8,-0.05*3.8,-0.05*3.8,0.15*3.8,0.15*3.8,0.15*3.8,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*4,-0.1*4,-0.1*4,-0.05*4,-0.05*4,-0.05*4,0.15*4,0.15*4,0.15*4,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*4.2,-0.1*4.2,-0.1*4.2,-0.05*4.2,-0.05*4.2,-0.05*4.2,0.15*4.2,0.15*4.2,0.15*4.2,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*4.4,-0.1*4.4,-0.1*4.4,-0.05*4.4,-0.05*4.4,-0.05*4.4,0.15*4.4,0.15*4.4,0.15*4.4,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*4.6,-0.1*4.6,-0.1*4.6,-0.05*4.6,-0.05*4.6,-0.05*4.6,0.15*4.6,0.15*4.6,0.15*4.6,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*4.8,-0.1*4.8,-0.1*4.8,-0.05*4.8,-0.05*4.8,-0.05*4.8,0.15*4.8,0.15*4.8,0.15*4.8,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(-0.1*5,-0.1*5,-0.1*5,-0.05*5,-0.05*5,-0.05*5,0.15*5,0.15*5,0.15*5,
                    10,10,10,15,15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha






p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,10,10,10,15,15,15,20,20,20,0.3,0.3,0.7,0.7,0.9,0.9,0.5,
                    0.5,1))
p;alpha<-mean(p);alpha
p<-replicate(2,fun4(0.2,0.2,0.2,0.1,0.1,0.1,0.3,0.3,0.3,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*1.2,0.2*1.2,0.2*1.2,0.1*1.2,0.1*1.2,0.1*1.2,0.3*1.2,0.3*1.2,0.3*1.2,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*1.4,0.2*1.4,0.2*1.4,0.1*1.4,0.1*1.4,0.1*1.4,0.3*1.4,0.3*1.4,0.3*1.4,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*1.6,0.2*1.6,0.2*1.6,0.1*1.6,0.1*1.6,0.1*1.6,0.3*1.6,0.3*1.6,0.3*1.6,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*1.8,0.2*1.8,0.2*1.8,0.1*1.8,0.1*1.8,0.1*1.8,0.3*1.8,0.3*1.8,0.3*1.8,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*2,0.2*2,0.2*2,0.1*2,0.1*2,0.1*2,0.3*2,0.3*2,0.3*2,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*2.2,0.2*2.2,0.2*2.2,0.1*2.2,0.1*2.2,0.1*2.2,0.3*2.2,0.3*2.2,0.3*2.2,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*2.4,0.2*2.4,0.2*2.4,0.1*2.4,0.1*2.4,0.1*2.4,0.3*2.4,0.3*2.4,0.3*2.4,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*2.6,0.2*2.6,0.2*2.6,0.1*2.6,0.1*2.6,0.1*2.6,0.3*2.6,0.3*2.6,0.3*2.6,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*2.8,0.2*2.8,0.2*2.8,0.1*2.8,0.1*2.8,0.1*2.8,0.3*2.8,0.3*2.8,0.3*2.8,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*3,0.2*3,0.2*3,0.1*3,0.1*3,0.1*3,0.3*3,0.3*3,0.3*3,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*3.2,0.2*3.2,0.2*3.2,0.1*3.2,0.1*3.2,0.1*3.2,0.3*3.2,0.3*3.2,0.3*3.2,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*3.4,0.2*3.4,0.2*3.4,0.1*3.4,0.1*3.4,0.1*3.4,0.3*3.4,0.3*3.4,0.3*3.4,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*3.6,0.2*3.6,0.2*3.6,0.1*3.6,0.1*3.6,0.1*3.6,0.3*3.6,0.3*3.6,0.3*3.6,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*3.8,0.2*3.8,0.2*3.8,0.1*3.8,0.1*3.8,0.1*3.8,0.3*3.8,0.3*3.8,0.3*3.8,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*4,0.2*4,0.2*4,0.1*4,0.1*4,0.1*4,0.3*4,0.3*4,0.3*4,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*4.2,0.2*4.2,0.2*4.2,0.1*4.2,0.1*4.2,0.1*4.2,0.3*4.2,0.3*4.2,0.3*4.2,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*4.4,0.2*4.4,0.2*4.4,0.1*4.4,0.1*4.4,0.1*4.4,0.3*4.4,0.3*4.4,0.3*4.410,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*4.6,0.2*4.6,0.2*4.6,0.1*4.6,0.1*4.6,0.1*4.6,0.3*4.6,0.3*4.6,0.3*4.6,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*4.8,0.2*4.8,0.2*4.8,0.1*4.8,0.1*4.8,0.1*4.8,0.3*4.8,0.3*4.8,0.3*4.8,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha
p<-replicate(3,fun4(0.2*5,0.2*5,0.2*5,0.1*5,0.1*5,0.1*5,0.3*5,0.3*5,0.3*5,10,10,10,15,
                    15,15,20,20,20,0.1,0.2,0.3,0.1,0.2,0.3,0.1,0.2,0.3))
alpha<-mean(p);alpha

