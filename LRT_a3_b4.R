rm(list=ls())
library(Iso)
library(smoothmest)


fun1<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,v11,v12,v13,v14,v21,v22,v23,v24,
               v31,v32,v33,v34)
{

  g11<-rnorm(n11,0,sqrt(v11));g12<-rnorm(n12,0,sqrt(v12))
  g13<-rnorm(n13,0,sqrt(v13));g14<-rnorm(n14,0,sqrt(v14))
  g21<-rnorm(n21,0,sqrt(v21));g22<-rnorm(n22,0,sqrt(v22))
  g23<-rnorm(n23,0,sqrt(v23));g24<-rnorm(n24,0,sqrt(v24))
  g31<-rnorm(n31,0,sqrt(v31));g32<-rnorm(n32,0,sqrt(v32))
  g33<-rnorm(n33,0,sqrt(v33));g34<-rnorm(n34,0,sqrt(v34))
  s11=var(g11);s12=var(g12);s13=var(g13);s14=var(g14)
  s21=var(g21);s22=var(g22);s23=var(g23);s24=var(g24)
  s31=var(g31);s32=var(g32);s33=var(g33);s34=var(g34)
  m11=mean(g11);m12=mean(g12);m13=mean(g13);m14=mean(g14)
  m21=mean(g21);m22=mean(g22);m23=mean(g23);m24=mean(g24)
  m31=mean(g31);m32=mean(g32);m33=mean(g33);m34=mean(g34)
  x1=(m11+m12+m13+m14)/4;x2=(m21+m22+m23+m24)/4;x3=(m31+m32+m33+m34)/4
  y1=(m11+m21+m31)/3;y2=(m12+m22+m32)/3;y3=(m13+m23+m33)/3;y4=(m14+m24+m34)/3
  m=(m11+m12+m13+m14+m21+m22+m23+m24+m31+m32+m33+m34)/12
  a=c(x1,x2,x3);b=c(y1-m,y2-m,y3-m,y4-m)
  x14=a;x15=b
  S11=s11;S12=s12;S13=s13;S14=s14;S21=s21;S22=s22;S23=s23;S24=s24;
  S31=s31;S32=s32;S33=s33;S34=s34
  #c(S11,S12,S21,S22,S31,S32,)
  #sum((g11-x14[1]-x15[1])^2)/n11;S12=sum((g12-x14[1]-x15[2])^2)/n12
  #S21=sum((g21-x14[2]-x15[1])^2)/n21;S22=sum((g22-x14[2]-x15[2])^2)/n22
  repeat
  {
    u11=n11/S11;u12=n12/S12;u13=n13/S13;u14=n14/S14
    u21=n21/S21;u22=n22/S22;u23=n23/S23;u24=n24/S24
    u31=n31/S31;u32=n32/S32;u33=n33/S33;u34=n34/S34
    u.1=(u11+u21+u31);u.2=(u12+u22+u32);u.3=(u13+u23+u33);u.4=(u14+u24+u34)
    u1.=(u11+u12+u13+u14);u2.=(u21+u22+u23+u24);u3.=(u31+u32+u33+u34)
    a10=((u11*m11+u12*m12+u13*m13+u14*m14)+((u14-u11)*x15[1]+(u14-u12)*x15[2]+(u14-u13)*x15[3]))/u1.
    a11=((u21*m21+u22*m22+u23*m23+u24*m24)+((u24-u21)*x15[1]+(u24-u22)*x15[2]+(u24-u23)*x15[3]))/u2.
    a13=((u31*m31+u32*m32+u33*m33+u34*m34)+((u34-u31)*x15[1]+(u34-u32)*x15[2]+(u34-u33)*x15[3]))/u3.
    w1=u11+u12+u13+u14;w2=u21+u22+u23+u24;w3=u31+u32+u33+u34
    alpha0<-c(a10,a11,a13)
    w=c(w1,w2,w3)
    alpha1=pava(alpha0,w)
    q=u14*(m14-alpha1[1])+u24*(m24-alpha1[2])+u34*(m34-alpha1[3])
    v1=(u11*(m11-alpha1[1])+u21*(m21-alpha1[2])+u31*(m31-alpha1[3]))-q
    v2=(u12*(m12-alpha1[1])+u22*(m22-alpha1[2])+u32*(m32-alpha1[3]))-q
    v3=(u13*(m13-alpha1[1])+u23*(m23-alpha1[2])+u33*(m33-alpha1[3]))-q
    v=matrix(c(v1,v2,v3),nrow=3,ncol=1,byrow=TRUE)
    A.data=c(u.1+u.4,u.4,u.4,u.4,u.2+u.4,u.4,u.4,u.4,u.3+u.4)
    A=matrix(A.data,nrow=3,ncol=3,byrow=TRUE)
    bn=solve(A)%*%v
    bn4=-(bn[1]+bn[2]+bn[3])
    b1=c(bn[1],bn[2],bn[3],bn4)
    S111=sum((g11-alpha1[1]-b1[1])^2)/n11;S112=sum((g12-alpha1[1]-b1[2])^2)/n12
    S113=sum((g13-alpha1[1]-b1[3])^2)/n13;S114=sum((g14-alpha1[1]-b1[4])^2)/n14
    S121=sum((g21-alpha1[2]-b1[1])^2)/n21;S122=sum((g22-alpha1[2]-b1[2])^2)/n22
    S123=sum((g23-alpha1[2]-b1[3])^2)/n23;S124=sum((g24-alpha1[2]-b1[4])^2)/n24
    S131=sum((g31-alpha1[3]-b1[1])^2)/n31;S132=sum((g32-alpha1[3]-b1[2])^2)/n32
    S133=sum((g33-alpha1[3]-b1[3])^2)/n33;S134=sum((g34-alpha1[3]-b1[4])^2)/n34
    c(S111,S112,S113,S114,S121,S122,S123,S124,S131,S132,S133,S134)
    M=max(abs(x14-alpha1));N=max(abs(x15-b1))
    if(M<=0.0000001 & N<=0.0000001)
    {
      break
    }
    S11=S111;S12=S112;S13=S113;S14=S114;S21=S121;S22=S122;S23=S123;S24=S124
    S31=S131;S32=S132;S33=S133;S34=S134
    x14=alpha1;x15=b1
  }
  u11=n11/s11;u12=n12/s12;u13=n13/s13;u14=n14/s14;u21=n21/s21;u22=n22/s22;u23=n23/s23;u24=n24/s24
  u31=n31/s31;u32=n32/s32;u33=n33/s33;u34=n34/s34
  U.1=u11+u21+u31;U.2=u12+u22+u32;U.3=u13+u23+u33;U.4=u14+u24+u34
  beta01=c((u11*m11+u21*m21+u31*m31)/U.1,(u12*m12+u22*m22+u32*m32)/U.2,
           (u13*m13+u23*m23+u33*m33)/U.3,(u14*m14+u24*m24+u34*m34)/U.4)
  x16=beta01
  s011=sum((g11-x16[1])^2)/n11;s012=sum((g12-x16[2])^2)/n12
  s013=sum((g13-x16[3])^2)/n13;s014=sum((g14-x16[4])^2)/n14
  s021=sum((g21-x16[1])^2)/n21;s022=sum((g22-x16[2])^2)/n22
  s023=sum((g23-x16[3])^2)/n23;s024=sum((g24-x16[4])^2)/n24
  s031=sum((g31-x16[1])^2)/n31;s032=sum((g32-x16[2])^2)/n32
  s033=sum((g33-x16[3])^2)/n33;s034=sum((g34-x16[4])^2)/n34
  repeat
  {
    u11=n11/s011;u12=n12/s012;u13=n13/s013;u14=n14/s014;u21=n21/s021;u22=n22/s022;u23=n23/s023
    u24=n24/s024;u31=n31/s031;u32=n32/s032;u33=n33/s033;u34=n34/s034
    U.1=u11+u21+u31;U.2=u12+u22+u32;U.3=u13+u23+u33;U.4=u14+u24+u34
    beta11=c((u11*m11+u21*m21+u31*m31)/U.1,(u12*m12+u22*m22+u32*m32)/U.2,
             (u13*m13+u23*m23+u33*m33)/U.3,(u14*m14+u24*m24+u34*m34)/U.4)
    dif=max(abs(x16-beta11))
    if(dif<=0.00001)
    {
      break
    }
    S011=sum((g11-beta11[1])^2)/n11;S012=sum((g12-beta11[2])^2)/n12
    S013=sum((g13-beta11[3])^2)/n13;S014=sum((g14-beta11[4])^2)/n14
    S021=sum((g21-beta11[1])^2)/n21;S022=sum((g22-beta11[2])^2)/n22
    S023=sum((g23-beta11[3])^2)/n23;S024=sum((g24-beta11[4])^2)/n24
    S031=sum((g31-beta11[1])^2)/n31;S032=sum((g32-beta11[2])^2)/n32
    S033=sum((g33-beta11[3])^2)/n33;S034=sum((g34-beta11[4])^2)/n34
    s011=S011;s012=S012;s013=S013;s014=S014;s021=S021;s022=S022;s023=S023;s024=S024
    s031=S031;s032=S032;s033=S033;s034=S034
    x16=beta11
  }
  #neu=(S111^(n11/2))*(S112^(n12/2))*(S113^(n13/2))*(S114^(n14/2))*(S121^(n21/2))*(S122^(n22/2))*(S123^(n23/2))*(S124^(n24/2))*(S131^(n31/2))*(S132^(n32/2))*(S133^(n33/2))*(S134^(n34/2))

  #dno=(S011^(n11/2))*(S012^(n12/2))*(S013^(n13/2))*(S014^(n14/2))*(S021^(n21/2))*(S022^(n22/2))*(S023^(n23/2))*(S024^(n24/2))*(S031^(n31/2))*(S032^(n32/2))*(S033^(n33/2))*(S034^(n34/2))
  value=(S111/s011)^(n11/2)*(S112/s012)^(n12/2)*(S113/s013)^(n13/2)*(S114/s014)^(n14/2)*
    (S121/s021)^(n21/2)*(S122/s022)^(n22/2)*(S123/s023)^(n23/2)*(S124/s024)^(n24/2)*
    (S131/s031)^(n31/2)*(S132/s032)^(n32/2)*(S133/s033)^(n33/2)*(S134/s034)^(n34/2)
  #value=neu/dno
  return(value)
}
#X=replicate(1000,fun1(10,10,10,20,15,15,10,20,20,10,10,15,1,1,1.5,1,1,1.5,2,1,1,1.5,1,1))
#plot(X)

fun2<-function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,v11,v12,v13,v14,v21,v22,v23,v24,
               v31,v32,v33,v34)
{
  x=replicate(1000,fun1(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,v11,v12,v13,v14,v21,v22,v23,v24,
                       v31,v32,v33,v34))
  y<-sort(x,decreasing=FALSE)
  c<-y[50]
  return(c)
}

fun3<-function(mu11,mu12,mu13,mu14,mu21,mu22,mu23,mu24,mu31,mu32,mu33,mu34,n11,n12,n13,n14,n21,n22,n23
               ,n24,n31,n32,n33,n34,v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34)
{
  ##For generating samples from Normal distributions
  g11<-rnorm(n11,mu11,sqrt(v11));g12<-rnorm(n12,mu12,sqrt(v12))
  g13<-rnorm(n13,mu13,sqrt(v13));g14<-rnorm(n14,mu14,sqrt(v14))
  g21<-rnorm(n21,mu21,sqrt(v21));g22<-rnorm(n22,mu22,sqrt(v22))
  g23<-rnorm(n23,mu23,sqrt(v23));g24<-rnorm(n24,mu24,sqrt(v24))
  g31<-rnorm(n31,mu31,sqrt(v31));g32<-rnorm(n32,mu32,sqrt(v32))
  g33<-rnorm(n33,mu33,sqrt(v33));g34<-rnorm(n34,mu34,sqrt(v34))
  ##For generating samples from t distributions
  #Y11=rt(n11,3,ncp=0)/sqrt(3);Y12=rt(n12,3,ncp=0)/sqrt(3);Y13=rt(n13,3,ncp=0)/sqrt(3)
  #Y14=rt(n14,3,ncp=0)/sqrt(3)
  #Y21=rt(n21,3,ncp=0)/sqrt(3);Y22=rt(n22,3,ncp=0)/sqrt(3);Y23=rt(n23,3,ncp=0)/sqrt(3)
  #Y24=rt(n24,3,ncp=0)/sqrt(3)
  #Y31=rt(n31,3,ncp=0)/sqrt(3);Y32=rt(n32,3,ncp=0)/sqrt(3);Y33=rt(n33,3,ncp=0)/sqrt(3)
  #Y34=rt(n34,3,ncp=0)/sqrt(3)
  #g11=sqrt(v11)*Y11+mu11;g12=sqrt(v12)*Y12+mu12;g13=sqrt(v13)*Y13+mu13;g14=sqrt(v14)*Y14+mu14
  #g21=sqrt(v21)*Y21+mu21;g22=sqrt(v22)*Y22+mu22;g23=sqrt(v23)*Y23+mu23;g24=sqrt(v24)*Y24+mu24
  #g31=sqrt(v31)*Y31+mu31;g32=sqrt(v32)*Y32+mu32;g33=sqrt(v33)*Y33+mu33;g34=sqrt(v34)*Y34+mu34
  ##For generating samples from exponential distributions
  #Y11=rexp(n11,1);Y12=rexp(n12,1);Y13=rexp(n13,1);Y14=rexp(n14,1)
  #Y21=rexp(n21,1);Y22=rexp(n22,1);Y23=rexp(n23,1);Y24=rexp(n24,1)
  #Y31=rexp(n31,1);Y32=rexp(n32,1);Y33=rexp(n33,1);Y34=rexp(n34,1)
  #g11=mu11+sqrt(v11)*(Y11-1);g12=mu12+sqrt(v12)*(Y12-1);g13=mu13+sqrt(v13)*(Y13-1);g14=mu14+sqrt(v14)*(Y14-1)
  #g21=mu21+sqrt(v21)*(Y21-1);g22=mu22+sqrt(v22)*(Y22-1);g23=mu23+sqrt(v23)*(Y23-1);g24=mu24+sqrt(v24)*(Y24-1)
  #g31=mu31+sqrt(v31)*(Y31-1);g32=mu32+sqrt(v32)*(Y32-1);g33=mu33+sqrt(v33)*(Y33-1);g34=mu34+sqrt(v34)*(Y34-1)
  ##For generating samples from Gamma distributions
  #Y11=(rgamma(n11,2,1)-2)/sqrt(2);Y12=(rgamma(n12,2,1)-2)/sqrt(2);Y13=(rgamma(n13,2,1)-2)/sqrt(2);Y14=(rgamma(n14,2,1)-2)/sqrt(2)
  #Y21=(rgamma(n21,2,1)-2)/sqrt(2);Y22=(rgamma(n22,2,1)-2)/sqrt(2);Y23=(rgamma(n23,2,1)-2)/sqrt(2);Y24=(rgamma(n24,2,1)-2)/sqrt(2)
  #Y31=(rgamma(n31,2,1)-2)/sqrt(2);Y32=(rgamma(n32,2,1)-2)/sqrt(2);Y33=(rgamma(n33,2,1)-2)/sqrt(2);Y34=(rgamma(n34,2,1)-2)/sqrt(2)
  #g11=mu11+sqrt(v11)*Y11;g12=mu12+sqrt(v12)*Y12;g13=mu13+sqrt(v13)*Y13;g14=mu14+sqrt(v14)*Y14
  #g21=mu21+sqrt(v21)*Y21;g22=mu22+sqrt(v22)*Y22;g23=mu23+sqrt(v23)*Y23;g24=mu24+sqrt(v24)*Y24
  #g31=mu31+sqrt(v31)*Y31;g32=mu32+sqrt(v32)*Y32;g33=mu33+sqrt(v33)*Y33;g34=mu34+sqrt(v34)*Y34
  ##For generating samples from lognormal distributions
  #Y11=(rlnorm(n11,0,1)-exp(.5))/sqrt(exp(2)-exp(1));Y12=(rlnorm(n12,0,1)-exp(.5))/sqrt(exp(2)-exp(1))
  #Y13=(rlnorm(n13,0,1)-exp(.5))/sqrt(exp(2)-exp(1));Y14=(rlnorm(n14,0,1)-exp(.5))/sqrt(exp(2)-exp(1))
  #Y21=(rlnorm(n21,0,1)-exp(.5))/sqrt(exp(2)-exp(1));Y22=(rlnorm(n22,0,1)-exp(.5))/sqrt(exp(2)-exp(1))
  #Y23=(rlnorm(n23,0,1)-exp(.5))/sqrt(exp(2)-exp(1));Y24=(rlnorm(n24,0,1)-exp(.5))/sqrt(exp(2)-exp(1))
  #Y31=(rlnorm(n31,0,1)-exp(.5))/sqrt(exp(2)-exp(1));Y32=(rlnorm(n32,0,1)-exp(.5))/sqrt(exp(2)-exp(1))
  #Y33=(rlnorm(n33,0,1)-exp(.5))/sqrt(exp(2)-exp(1));Y34=(rlnorm(n14,0,1)-exp(.5))/sqrt(exp(2)-exp(1))
  #g11=mu11+sqrt(v11)*Y11;g12=mu12+sqrt(v12)*Y12;g13=mu13+sqrt(v13)*Y13;g14=mu14+sqrt(v14)*Y14
  #g21=mu21+sqrt(v21)*Y21;g22=mu22+sqrt(v22)*Y22;g23=mu23+sqrt(v23)*Y23;g24=mu24+sqrt(v24)*Y24
  #g31=mu31+sqrt(v31)*Y31;g32=mu32+sqrt(v32)*Y32;g33=mu33+sqrt(v33)*Y33;g34=mu34+sqrt(v34)*Y34
  ##For generating samples from Laplace distributions
  #g11=rdoublex(n11,mu11,sqrt(v11)/sqrt(2));g12=rdoublex(n12,mu12,sqrt(v12)/sqrt(2))
  #g13=rdoublex(n13,mu13,sqrt(v13)/sqrt(2));g14=rdoublex(n14,mu14,sqrt(v14)/sqrt(2))
  #g21=rdoublex(n21,mu21,sqrt(v21)/sqrt(2));g22=rdoublex(n22,mu22,sqrt(v22)/sqrt(2))
  #g23=rdoublex(n23,mu23,sqrt(v23)/sqrt(2));g24=rdoublex(n24,mu24,sqrt(v24)/sqrt(2))
  #g31=rdoublex(n31,mu31,sqrt(v31)/sqrt(2));g32=rdoublex(n32,mu32,sqrt(v32)/sqrt(2))
  #g33=rdoublex(n33,mu33,sqrt(v33)/sqrt(2));g34=rdoublex(n34,mu34,sqrt(v34)/sqrt(2))
  ##For generating samples form Weibull distributions
  #Y11=(rweibull(n11,2,1)-sqrt(pi)/2)/sqrt(1-pi/4);Y12=(rweibull(n12,2,1)-sqrt(pi)/2)/sqrt(1-pi/4)
  #Y13=(rweibull(n13,2,1)-sqrt(pi)/2)/sqrt(1-pi/4);Y14=(rweibull(n14,2,1)-sqrt(pi)/2)/sqrt(1-pi/4)
  #Y21=(rweibull(n21,2,1)-sqrt(pi)/2)/sqrt(1-pi/4);Y22=(rweibull(n22,2,1)-sqrt(pi)/2)/sqrt(1-pi/4)
  #Y23=(rweibull(n23,2,1)-sqrt(pi)/2)/sqrt(1-pi/4);Y24=(rweibull(n24,2,1)-sqrt(pi)/2)/sqrt(1-pi/4)
  #Y31=(rweibull(n31,2,1)-sqrt(pi)/2)/sqrt(1-pi/4);Y32=(rweibull(n32,2,1)-sqrt(pi)/2)/sqrt(1-pi/4)
  #Y33=(rweibull(n33,2,1)-sqrt(pi)/2)/sqrt(1-pi/4);Y34=(rweibull(n34,2,1)-sqrt(pi)/2)/sqrt(1-pi/4)
  #g11=mu11+sqrt(v11)*Y11;g12=mu12+sqrt(v12)*Y12;g13=mu13+sqrt(v13)*Y13;g14=mu14+sqrt(v14)*Y14
  #g21=mu21+sqrt(v21)*Y21;g22=mu22+sqrt(v22)*Y22;g23=mu23+sqrt(v23)*Y23;g24=mu24+sqrt(v24)*Y24
  #g31=mu31+sqrt(v31)*Y31;g32=mu32+sqrt(v32)*Y32;g33=mu33+sqrt(v33)*Y33;g34=mu34+sqrt(v34)*Y34
  s11=var(g11);s12=var(g12);s13=var(g13);s14=var(g14)
  s21=var(g21);s22=var(g22);s23=var(g23);s24=var(g24)
  s31=var(g31);s32=var(g32);s33=var(g33);s34=var(g34)
  m11=mean(g11);m12=mean(g12);m13=mean(g13);m14=mean(g14)
  m21=mean(g21);m22=mean(g22);m23=mean(g23);m24=mean(g24)
  m31=mean(g31);m32=mean(g32);m33=mean(g33);m34=mean(g34)
  x1=(m11+m12+m13+m14)/4;x2=(m21+m22+m23+m24)/4;x3=(m31+m32+m33+m34)/4
  y1=(m11+m21+m31)/3;y2=(m12+m22+m32)/3;y3=(m13+m23+m33)/3;y4=(m14+m24+m34)/3
  m=(m11+m12+m13+m14+m21+m22+m23+m24+m31+m32+m33+m34)/12
  a=c(x1,x2,x3);b=c(y1-m,y2-m,y3-m,y4-m);sum(b)
  x14=a;x15=b
  S11=s11;S12=s12;S13=s13;S14=s14;S21=s21;S22=s22;S23=s23;S24=s24;
  S31=s31;S32=s32;S33=s33;S34=s34
  #c(S11,S12,S21,S22,S31,S32,)
  #sum((g11-x14[1]-x15[1])^2)/n11;S12=sum((g12-x14[1]-x15[2])^2)/n12
  #S21=sum((g21-x14[2]-x15[1])^2)/n21;S22=sum((g22-x14[2]-x15[2])^2)/n22
  repeat
  {
    u11=n11/S11;u12=n12/S12;u13=n13/S13;u14=n14/S14
    u21=n21/S21;u22=n22/S22;u23=n23/S23;u24=n24/S24
    u31=n31/S31;u32=n32/S32;u33=n33/S33;u34=n34/S34
    u.1=(u11+u21+u31);u.2=(u12+u22+u32);u.3=(u13+u23+u33);u.4=(u14+u24+u34)
    u1.=(u11+u12+u13+u14);u2.=(u21+u22+u23+u24);u3.=(u31+u32+u33+u34)
    a10=((u11*m11+u12*m12+u13*m13+u14*m14)+((u14-u11)*x15[1]+(u14-u12)*x15[2]+(u14-u13)*x15[3]))/u1.
    a11=((u21*m21+u22*m22+u23*m23+u24*m24)+((u24-u21)*x15[1]+(u24-u22)*x15[2]+(u24-u23)*x15[3]))/u2.
    a13=((u31*m31+u32*m32+u33*m33+u34*m34)+((u34-u31)*x15[1]+(u34-u32)*x15[2]+(u34-u33)*x15[3]))/u3.
    w1=u11+u12+u13+u14;w2=u21+u22+u23+u24;w3=u31+u32+u33+u34
    alpha0<-c(a10,a11,a13)
    w=c(w1,w2,w3)
    alpha1=pava(alpha0,w)
    q=u14*(m14-alpha1[1])+u24*(m24-alpha1[2])+u34*(m34-alpha1[3])
    v1=(u11*(m11-alpha1[1])+u21*(m21-alpha1[2])+u31*(m31-alpha1[3]))-q
    v2=(u12*(m12-alpha1[1])+u22*(m22-alpha1[2])+u32*(m32-alpha1[3]))-q
    v3=(u13*(m13-alpha1[1])+u23*(m23-alpha1[2])+u33*(m33-alpha1[3]))-q
    v=matrix(c(v1,v2,v3),nrow=3,ncol=1,byrow=TRUE)
    A.data=c(u.1+u.4,u.4,u.4,u.4,u.2+u.4,u.4,u.4,u.4,u.3+u.4)
    A=matrix(A.data,nrow=3,ncol=3,byrow=TRUE)
    bn=solve(A)%*%v
    bn4=-(bn[1]+bn[2]+bn[3])
    b1=c(bn[1],bn[2],bn[3],bn4)
    S111=sum((g11-alpha1[1]-b1[1])^2)/n11;S112=sum((g12-alpha1[1]-b1[2])^2)/n12
    S113=sum((g13-alpha1[1]-b1[3])^2)/n13;S114=sum((g14-alpha1[1]-b1[4])^2)/n14
    S121=sum((g21-alpha1[2]-b1[1])^2)/n21;S122=sum((g22-alpha1[2]-b1[2])^2)/n22
    S123=sum((g23-alpha1[2]-b1[3])^2)/n23;S124=sum((g24-alpha1[2]-b1[4])^2)/n24
    S131=sum((g31-alpha1[3]-b1[1])^2)/n31;S132=sum((g32-alpha1[3]-b1[2])^2)/n32
    S133=sum((g33-alpha1[3]-b1[3])^2)/n33;S134=sum((g34-alpha1[3]-b1[4])^2)/n34
    M=max(abs(x14-alpha1));N=max(abs(x15-b1))
    if(M<=0.0000001 & N<=0.0000001)
    {
      break
    }
    S11=S111;S12=S112;S13=S113;S14=S114;S21=S121;S22=S122;S23=S123;S24=S124
    S31=S131;S32=S132;S33=S133;S34=S134
    x14=alpha1;x15=b1
  }
  u11=n11/s11;u12=n12/s12;u13=n13/s13;u14=n14/s14;u21=n21/s21;u22=n22/s22;u23=n23/s23;u24=n24/s24
  u31=n31/s31;u32=n32/s32;u33=n33/s33;u34=n34/s34
  U.1=u11+u21+u31;U.2=u12+u22+u32;U.3=u13+u23+u33;U.4=u14+u24+u34
  beta01=c((u11*m11+u21*m21+u31*m31)/U.1,(u12*m12+u22*m22+u32*m32)/U.2,
           (u13*m13+u23*m23+u33*m33)/U.3,(u14*m14+u24*m24+u34*m34)/U.4)
  x16=beta01
  s011=sum((g11-x16[1])^2)/n11;s012=sum((g12-x16[2])^2)/n12
  s013=sum((g13-x16[3])^2)/n13;s014=sum((g14-x16[4])^2)/n14
  s021=sum((g21-x16[1])^2)/n21;s022=sum((g22-x16[2])^2)/n22
  s023=sum((g23-x16[3])^2)/n23;s024=sum((g24-x16[4])^2)/n24
  s031=sum((g31-x16[1])^2)/n31;s032=sum((g32-x16[2])^2)/n32
  s033=sum((g33-x16[3])^2)/n33;s034=sum((g34-x16[4])^2)/n34
  repeat
  {
    u11=n11/s011;u12=n12/s012;u13=n13/s013;u14=n14/s014;u21=n21/s021;u22=n22/s022;u23=n23/s023
    u24=n24/s024;u31=n31/s031;u32=n32/s032;u33=n33/s033;u34=n34/s034
    U.1=u11+u21+u31;U.2=u12+u22+u32;U.3=u13+u23+u33;U.4=u14+u24+u34
    beta11=c((u11*m11+u21*m21+u31*m31)/U.1,(u12*m12+u22*m22+u32*m32)/U.2,
             (u13*m13+u23*m23+u33*m33)/U.3,(u14*m14+u24*m24+u34*m34)/U.4)
    dif=max(abs(x16-beta11))
    if(dif<=0.00001)
    {
      break
    }
    S011=sum((g11-beta11[1])^2)/n11;S012=sum((g12-beta11[2])^2)/n12
    S013=sum((g13-beta11[3])^2)/n13;S014=sum((g14-beta11[4])^2)/n14
    S021=sum((g21-beta11[1])^2)/n21;S022=sum((g22-beta11[2])^2)/n22
    S023=sum((g23-beta11[3])^2)/n23;S024=sum((g24-beta11[4])^2)/n24
    S031=sum((g31-beta11[1])^2)/n31;S032=sum((g32-beta11[2])^2)/n32
    S033=sum((g33-beta11[3])^2)/n33;S034=sum((g34-beta11[4])^2)/n34
    s011=S011;s012=S012;s013=S013;s014=S014;s021=S021;s022=S022;s023=S023;s024=S024
    s031=S031;s032=S032;s033=S033;s034=S034
    x16=beta11
  }
  #neu=(S111)^(n11/2))*(S112^(n12/2))*(S113^(n13/2))*(S114^(n14/2))*(S121^(n21/2))*(S122^(n22/2))*(S123^(n23/2))*(S124^(n24/2))*(S131^(n31/2))*(S132^(n32/2))*(S133^(n33/2))*(S134^(n34/2))

  #dno=(S011^(n11/2))*(S012^(n12/2))*(S013^(n13/2))*(S014^(n14/2))*(S021^(n21/2))*(S022^(n22/2))*(S023^(n23/2))*(S024^(n24/2))*(S031^(n31/2))*(S032^(n32/2))*(S033^(n33/2))*(S034^(n34/2))

  #value=neu/dno
  value=(S111/s011)^(n11/2)*(S112/s012)^(n12/2)*(S113/s013)^(n13/2)*(S114/s014)^(n14/2)*
  (S121/s021)^(n21/2)*(S122/s022)^(n22/2)*(S123/s023)^(n23/2)*(S124/s024)^(n24/2)*
  (S131/s031)^(n31/2)*(S132/s032)^(n32/2)*(S133/s033)^(n33/2)*(S134/s034)^(n34/2)
  #return(value)
  out<-fun2(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,s11,s12,s13,s14,s21,s22,s23,s24,
            s31,s32,s33,s34)
  a=0
  if(value<out)
   a=a+1
  return(a)
}
#X=replicate(1000,fun3(0.1+0.1,0.1+0.1,0.1+0.2,0.1+0.2,0.2+0.1,0.2+0.1,0.2+0.2,0.2+0.2,0.3+0.1,0.3+0.1,0.3+0.2,0.3+0.2,10,10,10,20,15,15,10,20,20,10,10,15,
#                      1,1,1.5,1,1,1.5,2,1,1,1.5,1,1))
#plot(X)
fun4<-function(mu11,mu12,mu13,mu14,mu21,mu22,mu23,mu24,mu31,mu32,mu33,mu34,n11,n12,n13,n14,n21,n22,n23
               ,n24,n31,n32,n33,n34,v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34)
{
  X=replicate(1000,fun3(mu11,mu12,mu13,mu14,mu21,mu22,mu23,mu24,mu31,mu32,mu33,mu34,n11,n12,n13,n14,n21,n22,n23
                        ,n24,n31,n32,n33,n34,v11,v12,v13,v14,v21,v22,v23,v24,v31,v32,v33,v34))
  c=mean(X)
  return(c)
}

##Size values of Table 3.4

p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,8,8,4,4,6,6,15,15,10,10,10,10,8^2,8^2,4^2,4^2,6^2,6^2,1,
                    1,2,2,2,2))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,8,8,4,4,6,6,15,15,10,10,10,10,2,2,2,2,10^2,10^2,10^2,
                    10^2,1,1,1,1))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,8,8,4,4,6,6,15,15,10,10,10,10,1,7^2,2^2,0.5^2,4^2,8^2,1,
                    7^2,7^2,6^2,6^2,0.5^2))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,8,8,4,4,6,6,15,15,10,10,10,10,4^2,3^2,2^2,1,13^2,12^2,11^2,
                    10^2,4^2,3^2,2^2,1))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,8,8,4,4,6,6,15,15,10,10,10,10,10^2,10^2,10^2,10^2,10^2,10^2,10^2,
                    10^2,10^2,10^2,10^2,10^2))
p;alpha<-mean(p);alpha



p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,10,5,5,5,5,20,20,20,20,8^2,8^2,4^2,4^2,6^2,6^2,1,
                    1,2,2,2,2))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,10,5,5,5,5,20,20,20,20,2,2,2,2,10^2,10^2,10^2,
                    10^2,1,1,1,1))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,10,5,5,5,5,20,20,20,20,1,7^2,2^2,0.5^2,4^2,8^2,1,
                    7^2,7^2,6^2,6^2,0.5^2))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,10,5,5,5,5,20,20,20,20,4^2,3^2,2^2,1,13^2,12^2,11^2,
                    10^2,4^2,3^2,2^2,1))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,10,5,5,5,5,20,20,20,20,10^2,10^2,10^2,10^2,10^2,10^2,10^2,
                    10^2,10^2,10^2,10^2,10^2))
p;alpha<-mean(p);alpha



p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,20,5,10,30,10,5,15,5,5,6,6,18,8^2,8^2,4^2,4^2,6^2,6^2,1,
                    1,2,2,2,2))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,20,5,10,30,10,5,15,5,5,6,6,18,2,2,2,2,10^2,10^2,10^2,
                    10^2,1,1,1,1))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,20,5,10,30,10,5,15,5,5,6,6,18,1,7^2,2^2,0.5^2,4^2,8^2,1,
                    7^2,7^2,6^2,6^2,0.5^2))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,20,5,10,30,10,5,15,5,5,6,6,18,4^2,3^2,2^2,1,13^2,12^2,11^2,
                    10^2,4^2,3^2,2^2,1))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,20,5,10,30,10,5,15,5,5,6,6,18,10^2,10^2,10^2,10^2,10^2,10^2,10^2,
                    10^2,10^2,10^2,10^2,10^2))
p;alpha<-mean(p);alpha




p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,30,25,20,15,8,9,10,11,40,45,50,55,8^2,8^2,4^2,4^2,6^2,6^2,1,
                    1,2,2,2,2))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,30,25,20,15,8,9,10,11,40,45,50,55,2,2,2,2,10^2,10^2,10^2,
                    10^2,1,1,1,1))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,30,25,20,15,8,9,10,11,40,45,50,55,1,7^2,2^2,0.5^2,4^2,8^2,1,
                    7^2,7^2,6^2,6^2,0.5^2))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,30,25,20,15,8,9,10,11,40,45,50,55,4^2,3^2,2^2,1,13^2,12^2,11^2,
                    10^2,4^2,3^2,2^2,1))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,30,25,20,15,8,9,10,11,40,45,50,55,10^2,10^2,10^2,10^2,10^2,10^2,10^2,
                    10^2,10^2,10^2,10^2,10^2))
p;alpha<-mean(p);alpha


p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,25,30,25,30,25,30,25,30,25,30,25,30,8^2,8^2,4^2,4^2,6^2,6^2,1,
                    1,2,2,2,2))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,25,30,25,30,25,30,25,30,25,30,25,30,2,2,2,2,10^2,10^2,10^2,
                    10^2,1,1,1,1))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,25,30,25,30,25,30,25,30,25,30,25,30,1,7^2,2^2,0.5^2,4^2,8^2,1,
                    7^2,7^2,6^2,6^2,0.5^2))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,25,30,25,30,25,30,25,30,25,30,25,30,4^2,3^2,2^2,1,13^2,12^2,11^2,
                    10^2,4^2,3^2,2^2,1))
p;alpha<-mean(p);alpha
p<-replicate(1,fun4(0,0,0,0,0,0,0,0,0,0,0,0,25,30,25,30,25,30,25,30,25,30,25,30,10^2,10^2,10^2,10^2,10^2,10^2,10^2,
                    10^2,10^2,10^2,10^2,10^2))
p;alpha<-mean(p);alpha




p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,10,8,8,8,8,12,12,12,12,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
                    0.1,0.1,0.1,0.1,0.1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,10,8,8,8,8,12,12,12,12,0.5,0.5,0.5,0.5,0.4,0.4,0.4,
                    0.4,0.3,0.3,0.3,0.3))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,10,8,8,8,8,12,12,12,12,1,0.5,1.5,2,1,0.5,1.5,
                    2,1,0.5,1.5,2))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,10,8,8,8,8,12,12,12,12,1,0.4,0.3,0.5,0.6,0.2,0.3,
                    0.4,0.2,0.3,0.4,0.5))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,10,8,8,8,8,12,12,12,12,0.5,0.6,0.7,0.8,0.9,1,0.5,
                    0.6,0.7,0.8,0.9,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,10,8,8,8,8,12,12,12,12,1,1,1,1,1,1,1,
                    1,1,1,1,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,10,8,8,8,8,12,12,12,12,1,0.9,0.8,0.7,0.6,0.6,0.6,0.5,
                    0.4,0.3,0.2,0.1))
p;alpha<-mean(p);alpha



p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,15,15,10,12,12,13,14,15,10,12,11,14,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
                    0.1,0.1,0.1,0.1,0.1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,15,15,10,12,12,13,14,15,10,12,11,14,0.5,0.5,0.5,0.5,0.4,0.4,0.4,
                    0.4,0.3,0.3,0.3,0.3))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,15,15,10,12,12,13,14,15,10,12,11,14,1,0.5,1.5,2,1,0.5,1.5,
                    2,1,0.5,1.5,2))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,15,15,10,12,12,13,14,15,10,12,11,14,1,0.4,0.3,0.5,0.6,0.2,0.3,
                    0.4,0.2,0.3,0.4,0.5))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,15,15,10,12,12,13,14,15,10,12,11,14,0.5,0.6,0.7,0.8,0.9,1,0.5,
                    0.6,0.7,0.8,0.9,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,15,15,10,12,12,13,14,15,10,12,11,14,1,1,1,1,1,1,1,
                    1,1,1,1,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,15,15,10,12,12,13,14,15,10,12,11,14,1,0.9,0.8,0.7,0.6,0.6,0.6,0.5,
                    0.4,0.3,0.2,0.1))
p;alpha<-mean(p);alpha



p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,20,15,10,15,20,15,10,15,20,15,10,15,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
                    0.1,0.1,0.1,0.1,0.1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,20,15,10,15,20,15,10,15,20,15,10,15,0.5,0.5,0.5,0.5,0.4,0.4,0.4,
                    0.4,0.3,0.3,0.3,0.3))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,20,15,10,15,20,15,10,15,20,15,10,15,1,0.5,1.5,2,1,0.5,1.5,
                    2,1,0.5,1.5,2))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,20,15,10,15,20,15,10,15,20,15,10,15,1,0.4,0.3,0.5,0.6,0.2,0.3,
                    0.4,0.2,0.3,0.4,0.5))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,20,15,10,15,20,15,10,15,20,15,10,15,0.5,0.6,0.7,0.8,0.9,1,0.5,
                    0.6,0.7,0.8,0.9,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,20,15,10,15,20,15,10,15,20,15,10,15,1,1,1,1,1,1,1,
                    1,1,1,1,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,20,15,10,15,20,15,10,15,20,15,10,15,1,0.9,0.8,0.7,0.6,0.6,0.6,0.5,
                    0.4,0.3,0.2,0.1))
p;alpha<-mean(p);alpha




p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,7,8,9,10,7,15,20,10,8,9,10,10,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
                    0.1,0.1,0.1,0.1,0.1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,7,8,9,10,7,15,20,10,8,9,10,10,0.5,0.5,0.5,0.5,0.4,0.4,0.4,
                    0.4,0.3,0.3,0.3,0.3))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,7,8,9,10,7,15,20,10,8,9,10,10,1,0.5,1.5,2,1,0.5,1.5,
                    2,1,0.5,1.5,2))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,7,8,9,10,7,15,20,10,8,9,10,10,1,0.4,0.3,0.5,0.6,0.2,0.3,
                    0.4,0.2,0.3,0.4,0.5))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,7,8,9,10,7,15,20,10,8,9,10,10,0.5,0.6,0.7,0.8,0.9,1,0.5,
                    0.6,0.7,0.8,0.9,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,7,8,9,10,7,15,20,10,8,9,10,10,1,1,1,1,1,1,1,
                    1,1,1,1,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,7,8,9,10,7,15,20,10,8,9,10,10,1,0.9,0.8,0.7,0.6,0.6,0.6,0.5,
                    0.4,0.3,0.2,0.1))
p;alpha<-mean(p);alpha


p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
                    0.1,0.1,0.1,0.1,0.1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,0.5,0.5,0.5,0.5,0.4,0.4,0.4,
                    0.4,0.3,0.3,0.3,0.3))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,1,0.5,1.5,2,1,0.5,1.5,
                    2,1,0.5,1.5,2))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,1,0.4,0.3,0.5,0.6,0.2,0.3,
                    0.4,0.2,0.3,0.4,0.5))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,0.5,0.6,0.7,0.8,0.9,1,0.5,
                    0.6,0.7,0.8,0.9,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,1,1,1,1,1,1,1,
                    1,1,1,1,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,1,0.9,0.8,0.7,0.6,0.6,0.6,0.5,
                    0.4,0.3,0.2,0.1))
p;alpha<-mean(p);alpha


p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,3,3,4,5,6,6,3,3,4,5,6,6,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
                    0.1,0.1,0.1,0.1,0.1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,3,3,4,5,6,6,3,3,4,5,6,6,0.5,0.5,0.5,0.5,0.4,0.4,0.4,
                    0.4,0.3,0.3,0.3,0.3))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,3,3,4,5,6,6,3,3,4,5,6,6,1,0.5,1.5,2,1,0.5,1.5,
                    2,1,0.5,1.5,2))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,3,3,4,5,6,6,3,3,4,5,6,6,1,0.4,0.3,0.5,0.6,0.2,0.3,
                    0.4,0.2,0.3,0.4,0.5))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,3,3,4,5,6,6,3,3,4,5,6,6,0.5,0.6,0.7,0.8,0.9,1,0.5,
                    0.6,0.7,0.8,0.9,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,3,3,4,5,6,6,3,3,4,5,6,6,1,1,1,1,1,1,1,
                    1,1,1,1,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,3,3,4,5,6,6,3,3,4,5,6,6,1,0.9,0.8,0.7,0.6,0.6,0.6,0.5,
                    0.4,0.3,0.2,0.1))
p;alpha<-mean(p);alpha


p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,18,16,14,12,10,8,8,10,12,14,16,18,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
                    0.1,0.1,0.1,0.1,0.1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,18,16,14,12,10,8,8,10,12,14,16,18,0.5,0.5,0.5,0.5,0.4,0.4,0.4,
                    0.4,0.3,0.3,0.3,0.3))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,18,16,14,12,10,8,8,10,12,14,16,18,1,0.5,1.5,2,1,0.5,1.5,
                    2,1,0.5,1.5,2))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,18,16,14,12,10,8,8,10,12,14,16,18,1,0.4,0.3,0.5,0.6,0.2,0.3,
                    0.4,0.2,0.3,0.4,0.5))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,18,16,14,12,10,8,8,10,12,14,16,18,0.5,0.6,0.7,0.8,0.9,1,0.5,
                    0.6,0.7,0.8,0.9,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,18,16,14,12,10,8,8,10,12,14,16,18,1,1,1,1,1,1,1,
                    1,1,1,1,1))
p;alpha<-mean(p);alpha
p<-replicate(5,fun4(0,0,0,0,0,0,0,0,0,0,0,0,18,16,14,12,10,8,8,10,12,14,16,18,1,0.9,0.8,0.7,0.6,0.6,0.6,0.5,
                    0.4,0.3,0.2,0.1))
p;alpha<-mean(p);alpha

